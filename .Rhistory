column="GENESEQEND",
keytype="GENEID",
multiVals="first")
diffGATALOHtable$temp <- NULL
diffGATALOHtable <- diffGATALOHtable %>% arrange(foldChange) %>% dplyr::filter(padj < 0.05) %>% dplyr::filter(abs(foldChange)>1.5)
top_n(diffGATALOHtable, 10, foldChange)
top_n(diffGATALOHtable, -10, foldChange)
diffGATALOHtable$baseMean <- NULL
write.csv(diffGATALOHtable, file = "RNA-DE-Nigerian-GATA3-LOH.csv", row.names =FALSE)
diffGATAmut<- results(ddsGATA, contrast=c("sampleCondition", "GATA3mut", "GATA3wt"), pAdjustMethod ="fdr", alpha=fdr)
diffGATAmut$foldChange <- NA
row.pos <- which(! is.na(diffGATAmut$log2FoldChange) &
diffGATAmut$log2FoldChange >= 0)
row.neg <- which(! is.na(diffGATAmut$log2FoldChange) &
diffGATAmut$log2FoldChange < 0)
diffGATAmut$foldChange[row.pos] <- 2^diffGATAmut$log2FoldChange[row.pos]
diffGATAmut$foldChange[row.neg] <- -2^((-1) * diffGATAmut$log2FoldChange[row.neg])
nrow(diffGATAmut)
diffGATAmut <- diffGATAmut[(diffGATAmut$foldChange > fc | diffGATAmut$foldChange < -fc),]
diffGATAmut <- subset(diffGATAmut, padj < fdr)
nrow(diffGATAmut)
restemp <- lfcShrink(ddsGATA, contrast=c("sampleCondition", "GATA3mut", "GATA3wt"), res = diffGATAmut, type="ashr")
restemp$temp <- row.names(restemp)
restemp$temp <- gsub("[.].+", "", restemp$temp)
restemp$symbol <- mapIds(EnsDb.Hsapiens.v75,
keys=restemp$temp,
column="SYMBOL",
keytype="GENEID",
multiVals="first")
with(restemp, plot(log2FoldChange, -log10(padj), pch=20, main="Volcano plot of differential gene expression between \nbreast cancers in Nigerian patients with and without GATA3 mutations", xlim=c(-60,60), ylim=c(0,60)))
with(subset(restemp, padj<0.05 & (2^(abs(log2FoldChange))>50)), points(log2FoldChange, -log10(padj), pch=20, col="blue"))
with(subset(restemp, padj<0.05 & (2^(abs(log2FoldChange))>50)), textxy(log2FoldChange, -log10(padj), labs=symbol, cex=.5))
diffGATAmuttable <- as.data.frame(diffGATAmut)
diffGATAmuttable$temp <- row.names(diffGATAmut)
diffGATAmuttable$temp <- gsub("[.].+", "", diffGATAmuttable$temp)
diffGATAmuttable$symbol <- mapIds(EnsDb.Hsapiens.v75,
keys=diffGATAmuttable$temp,
column="SYMBOL",
keytype="GENEID",
multiVals="first")
diffGATAmuttable$biotype <- mapIds(EnsDb.Hsapiens.v75,
keys=diffGATAmuttable$temp,
column="GENEBIOTYPE",
keytype="GENEID",
multiVals="first")
diffGATAmuttable$chr <- mapIds(EnsDb.Hsapiens.v75,
keys=diffGATAmuttable$temp,
column="SEQNAME",
keytype="GENEID",
multiVals="first")
diffGATAmuttable$locstart <- mapIds(EnsDb.Hsapiens.v75,
keys=diffGATAmuttable$temp,
column="GENESEQSTART",
keytype="GENEID",
multiVals="first")
diffGATAmuttable$locend <- mapIds(EnsDb.Hsapiens.v75,
keys=diffGATAmuttable$temp,
column="GENESEQEND",
keytype="GENEID",
multiVals="first")
diffGATAmuttable$temp <- NULL
diffGATAmuttable <- diffGATAmuttable %>% arrange(foldChange) %>% dplyr::filter(padj < 0.05) %>% dplyr::filter(abs(foldChange)>1.5)
top_n(diffGATAmuttable, 10, foldChange)
top_n(diffGATAmuttable, -10, foldChange)
diffGATAmuttable$baseMean <- NULL
write.csv(diffGATAmuttable, file = "RNA-DE-Nigerian-GATA3-mutations.csv", row.names =FALSE)
sampleTableGATA <- data.frame(sampleName=gsub(".htseq.counts","",sampleFiles),
fileName=sampleFiles,
condition1=sampleConditionrace,
condition2=sampleGATA3,
batch=sampleConditionIHC)
View(sampleTableGATA)
sampleTableGATA$condition1 <- ifelse (grepl("TCGA_black",sampleTableGATA$condition1), "TCGA_black", NA)
sampleTableGATA <- sampleTableGATA %>% subset(is.na(sampleTableGATA$condition1)==FALSE)
View(sampleTableGATA)
sampleTableGATA <- data.frame(sampleName=gsub(".htseq.counts","",sampleFiles),
fileName=sampleFiles,
condition1=sampleConditionrace,
condition2=sampleGATA3,
batch=sampleConditionIHC)
sampleTableGATA$condition1 <- ifelse (grepl("TCGA_white",sampleTableGATA$condition1), "TCGA_white", NA)
sampleTableGATA <- sampleTableGATA %>% subset(is.na(sampleTableGATA$condition1)==FALSE)
sampleTableGATA <- data.frame(sampleName=gsub(".htseq.counts","",sampleFiles),
fileName=sampleFiles,
condition1=sampleConditionrace,
condition2=sampleGATA3,
batch=sampleConditionIHC)
sampleTableGATA$condition1 <- ifelse (grepl("Nigerian",sampleTableGATA$condition1), "Nigerian", NA)
sampleTableGATA <- sampleTableGATA %>% subset(is.na(sampleTableGATA$condition1)==FALSE)
table(sampleTableGATA$condition2)
plotCounts(ddsGATA, gene="ENSG00000107485.11", intgroup=c("sampleCondition", "batch"), main="Distribution of GATA3 expression by breast cancer subtype / mutation status in Nigerian patients")
sampleTableTP53 <- data.frame(sampleName=gsub(".htseq.counts","",sampleFiles),
fileName=sampleFiles,
condition1=sampleConditionrace,
condition2=sampleTP53,
batch=sampleConditionIHC)
View(sampleTableTP53)
sampleTableTP53$condition1 <- ifelse (grepl("Nigerian",sampleTableTP53$condition1), "Nigerian", NA)
sampleTableTP53 <- sampleTableTP53 %>% subset(is.na(sampleTableTP53$condition1)==FALSE)
sampleTableTP53$sampleCondition <- sampleTableTP53$condition2
sampleTableTP53$condition1 <- NULL
sampleTableTP53$condition2 <- NULL
View(sampleTableTP53)
ddsHTSeqMFTP53 <- DESeqDataSetFromHTSeqCount(
sampleTable=sampleTableTP53,
directory=FOLDER,
design=~sampleCondition+batch)
ddsHTSeqMFTP53 <- ddsHTSeqMFTP53[rowSums(counts(ddsHTSeqMFTP53)) > 0, ]
ddsHTSeqMFTP53$sampleCondition <- relevel(ddsHTSeqMFTP53$sampleCondition, ref = "TP53wt")
ddsTP53 <- estimateSizeFactors(ddsHTSeqMFTP53)
vsdTP53 <- vst(ddsHTSeqMFTP53, blind=FALSE)
plotPCA(vsdTP53, intgroup=c("sampleCondition", "batch"))
plotPCA(vsdTP53, intgroup="sampleCondition")
plotPCA(vsdTP53, intgroup=c("sampleCondition", "batch"))
ddsTP53 <- DESeq(ddsHTSeqMFTP53)
resultsNames(ddsTP53)
cat("MA Plot: Differential expression based on TP53 single-hit status in Nigerians")
resGATALOH <- lfcShrink(ddsTP53, coef="sampleCondition_TP53single_vs_TP53wt", type="ashr")
DESeq2::plotMA(resGATALOH, ylim=c(-10,10), xlim=c(0.1,200))
cat("MA Plot: Differential expression based on TP53 single-hit status in Nigerians")
resTP53singlehit <- lfcShrink(ddsTP53, coef="sampleCondition_TP53single_vs_TP53wt", type="ashr")
DESeq2::plotMA(resTP53singlehit, ylim=c(-10,10), xlim=c(0.1,200))
cat("MA Plot: Differential expression based on TP53 double-hit status in Nigerians")
resTP53doublehit <- lfcShrink(ddsTP53, coef="sampleCondition_TP53double_vs_TP53wt", type="ashr")
DESeq2::plotMA(resTP53doublehit, ylim=c(-10,10), xlim=c(0.1,200))
plotCounts(ddsTP53, gene="ENSG00000141510.11", intgroup=c("sampleCondition", "batch"), main="Distribution of TP53 expression by breast cancer subtype / hit status in Nigerian patients")
diffTP53single<- results(ddsTP53, contrast=c("sampleCondition", "TP53single", "TP53wt"), pAdjustMethod ="fdr", alpha=fdr)
diffTP53single$foldChange <- NA
row.pos <- which(! is.na(diffTP53single$log2FoldChange) &
diffTP53single$log2FoldChange >= 0)
row.neg <- which(! is.na(diffTP53single$log2FoldChange) &
diffTP53single$log2FoldChange < 0)
diffTP53single$foldChange[row.pos] <- 2^diffTP53single$log2FoldChange[row.pos]
diffTP53single$foldChange[row.neg] <- -2^((-1) * diffTP53single$log2FoldChange[row.neg])
nrow(diffTP53single)
diffTP53single <- diffTP53single[(diffTP53single$foldChange > fc | diffTP53single$foldChange < -fc),]
diffTP53single <- subset(diffTP53single, padj < fdr)
nrow(diffTP53single)
restemp <- lfcShrink(ddsTP53, contrast=c("sampleCondition", "GATA3LOH", "GATA3wt"), res = diffTP53single, type="ashr")
restemp$temp <- row.names(restemp)
restemp$temp <- gsub("[.].+", "", restemp$temp)
restemp$symbol <- mapIds(EnsDb.Hsapiens.v75,
keys=restemp$temp,
column="SYMBOL",
keytype="GENEID",
multiVals="first")
with(restemp, plot(log2FoldChange, -log10(padj), pch=20, main="Volcano plot of differential gene expression between \nbreast cancers in Nigerian patients with and without TP53 single-hit mutations", xlim=c(-60,60), ylim=c(0,60)))
with(subset(restemp, padj<0.05 & (2^(abs(log2FoldChange))>50)), points(log2FoldChange, -log10(padj), pch=20, col="blue"))
with(subset(restemp, padj<0.05 & (2^(abs(log2FoldChange))>50)), textxy(log2FoldChange, -log10(padj), labs=symbol, cex=.5))
diffTP53singletable <- as.data.frame(diffTP53single)
diffTP53singletable$temp <- row.names(diffTP53single)
diffTP53singletable$temp <- gsub("[.].+", "", diffTP53singletable$temp)
diffTP53singletable$symbol <- mapIds(EnsDb.Hsapiens.v75,
keys=diffTP53singletable$temp,
column="SYMBOL",
keytype="GENEID",
multiVals="first")
diffTP53singletable$biotype <- mapIds(EnsDb.Hsapiens.v75,
keys=diffTP53singletable$temp,
column="GENEBIOTYPE",
keytype="GENEID",
multiVals="first")
diffTP53singletable$chr <- mapIds(EnsDb.Hsapiens.v75,
keys=diffTP53singletable$temp,
column="SEQNAME",
keytype="GENEID",
multiVals="first")
diffTP53singletable$locstart <- mapIds(EnsDb.Hsapiens.v75,
keys=diffTP53singletable$temp,
column="GENESEQSTART",
keytype="GENEID",
multiVals="first")
diffTP53singletable$locend <- mapIds(EnsDb.Hsapiens.v75,
keys=diffTP53singletable$temp,
column="GENESEQEND",
keytype="GENEID",
multiVals="first")
diffTP53singletable$temp <- NULL
diffTP53singletable <- diffTP53singletable %>% arrange(foldChange) %>% dplyr::filter(padj < 0.05) %>% dplyr::filter(abs(foldChange)>1.5)
top_n(diffTP53singletable, 10, foldChange)
top_n(diffTP53singletable, -10, foldChange)
diffTP53singletable$baseMean <- NULL
write.csv(diffTP53singletable, file = "RNA-DE-Nigerian-TP53-singlehit.csv", row.names =FALSE)
diffTP53double<- results(ddsTP53, contrast=c("sampleCondition", "TP53double", "TP53wt"), pAdjustMethod ="fdr", alpha=fdr)
diffTP53double$foldChange <- NA
row.pos <- which(! is.na(diffTP53double$log2FoldChange) &
diffTP53double$log2FoldChange >= 0)
row.neg <- which(! is.na(diffTP53double$log2FoldChange) &
diffTP53double$log2FoldChange < 0)
diffTP53double$foldChange[row.pos] <- 2^diffTP53double$log2FoldChange[row.pos]
diffTP53double$foldChange[row.neg] <- -2^((-1) * diffTP53double$log2FoldChange[row.neg])
nrow(diffTP53double)
diffTP53double <- diffTP53double[(diffTP53double$foldChange > fc | diffTP53double$foldChange < -fc),]
diffTP53double <- subset(diffTP53double, padj < fdr)
nrow(diffTP53double)
restemp <- lfcShrink(ddsTP53, contrast=c("sampleCondition", "TP53double", "TP53wt"), res = diffTP53double, type="ashr")
restemp$temp <- row.names(restemp)
restemp$temp <- gsub("[.].+", "", restemp$temp)
restemp$symbol <- mapIds(EnsDb.Hsapiens.v75,
keys=restemp$temp,
column="SYMBOL",
keytype="GENEID",
multiVals="first")
with(restemp, plot(log2FoldChange, -log10(padj), pch=20, main="Volcano plot of differential gene expression between \nbreast cancers in Nigerian patients with and without TP53 double hit mutations", xlim=c(-60,60), ylim=c(0,60)))
with(subset(restemp, padj<0.05 & (2^(abs(log2FoldChange))>50)), points(log2FoldChange, -log10(padj), pch=20, col="blue"))
with(subset(restemp, padj<0.05 & (2^(abs(log2FoldChange))>50)), textxy(log2FoldChange, -log10(padj), labs=symbol, cex=.5))
restemp <- lfcShrink(ddsTP53, contrast=c("sampleCondition", "TP53single", "TP53wt"), res = diffTP53single, type="ashr")
restemp$temp <- row.names(restemp)
restemp$temp <- gsub("[.].+", "", restemp$temp)
restemp$symbol <- mapIds(EnsDb.Hsapiens.v75,
keys=restemp$temp,
column="SYMBOL",
keytype="GENEID",
multiVals="first")
with(restemp, plot(log2FoldChange, -log10(padj), pch=20, main="Volcano plot of differential gene expression between \nbreast cancers in Nigerian patients with and without TP53 single-hit mutations", xlim=c(-60,60), ylim=c(0,60)))
with(subset(restemp, padj<0.05 & (2^(abs(log2FoldChange))>50)), points(log2FoldChange, -log10(padj), pch=20, col="blue"))
with(subset(restemp, padj<0.05 & (2^(abs(log2FoldChange))>50)), textxy(log2FoldChange, -log10(padj), labs=symbol, cex=.5))
restemp <- lfcShrink(ddsTP53, contrast=c("sampleCondition", "TP53double", "TP53wt"), res = diffTP53double, type="ashr")
restemp$temp <- row.names(restemp)
restemp$temp <- gsub("[.].+", "", restemp$temp)
restemp$symbol <- mapIds(EnsDb.Hsapiens.v75,
keys=restemp$temp,
column="SYMBOL",
keytype="GENEID",
multiVals="first")
with(restemp, plot(log2FoldChange, -log10(padj), pch=20, main="Volcano plot of differential gene expression between \nbreast cancers in Nigerian patients with and without TP53 double hit mutations", xlim=c(-60,60), ylim=c(0,60)))
with(subset(restemp, padj<0.05 & (2^(abs(log2FoldChange))>50)), points(log2FoldChange, -log10(padj), pch=20, col="blue"))
with(subset(restemp, padj<0.05 & (2^(abs(log2FoldChange))>50)), textxy(log2FoldChange, -log10(padj), labs=symbol, cex=.5))
diffTP53doubletable <- as.data.frame(diffTP53double)
diffTP53doubletable$temp <- row.names(diffTP53double)
diffTP53doubletable$temp <- gsub("[.].+", "", diffTP53doubletable$temp)
diffTP53doubletable$symbol <- mapIds(EnsDb.Hsapiens.v75,
keys=diffTP53doubletable$temp,
column="SYMBOL",
keytype="GENEID",
multiVals="first")
diffTP53doubletable$biotype <- mapIds(EnsDb.Hsapiens.v75,
keys=diffTP53doubletable$temp,
column="GENEBIOTYPE",
keytype="GENEID",
multiVals="first")
diffTP53doubletable$chr <- mapIds(EnsDb.Hsapiens.v75,
keys=diffTP53doubletable$temp,
column="SEQNAME",
keytype="GENEID",
multiVals="first")
diffTP53doubletable$locstart <- mapIds(EnsDb.Hsapiens.v75,
keys=diffTP53doubletable$temp,
column="GENESEQSTART",
keytype="GENEID",
multiVals="first")
diffTP53doubletable$locend <- mapIds(EnsDb.Hsapiens.v75,
keys=diffTP53doubletable$temp,
column="GENESEQEND",
keytype="GENEID",
multiVals="first")
diffTP53doubletable$temp <- NULL
diffTP53doubletable <- diffTP53doubletable %>% arrange(foldChange) %>% dplyr::filter(padj < 0.05) %>% dplyr::filter(abs(foldChange)>1.5)
top_n(diffTP53doubletable, 10, foldChange)
top_n(diffTP53doubletable, -10, foldChange)
diffTP53doubletable$baseMean <- NULL
write.csv(diffTP53doubletable, file = "RNA-DE-Nigerian-TP53-doublehit.csv", row.names =FALSE)
sampleTableTP53 <- data.frame(sampleName=gsub(".htseq.counts","",sampleFiles),
fileName=sampleFiles,
condition1=sampleConditionrace,
condition2=sampleTP53,
batch=sampleConditionIHC)
sampleTableTP53$condition1 <- ifelse (grepl("TCGA_black",sampleTableTP53$condition1), "TCGA_black", NA)
sampleTableTP53 <- sampleTableTP53 %>% subset(is.na(sampleTableTP53$condition1)==FALSE)
table(sampleTableTP53$condition2)
sampleTableTP53 <- data.frame(sampleName=gsub(".htseq.counts","",sampleFiles),
fileName=sampleFiles,
condition1=sampleConditionrace,
condition2=sampleTP53,
batch=sampleConditionIHC)
sampleTableTP53$condition1 <- ifelse (grepl("TCGA_white",sampleTableTP53$condition1), "TCGA_white", NA)
sampleTableTP53 <- sampleTableTP53 %>% subset(is.na(sampleTableTP53$condition1)==FALSE)
table(sampleTableTP53$condition2)
sampleTableTP53 <- data.frame(sampleName=gsub(".htseq.counts","",sampleFiles),
fileName=sampleFiles,
condition1=sampleConditionrace,
condition2=sampleTP53,
batch=sampleConditionIHC)
sampleTableTP53$condition1 <- ifelse (grepl("TCGA_white",sampleTableTP53$condition1), "TCGA_white", NA)
sampleTableTP53 <- sampleTableTP53 %>% subset(is.na(sampleTableTP53$condition1)==FALSE)
sampleTableTP53$sampleCondition <- sampleTableTP53$condition2
sampleTableTP53$condition1 <- NULL
sampleTableTP53$condition2 <- NULL
ddsHTSeqMFTP53 <- DESeqDataSetFromHTSeqCount(
sampleTable=sampleTableTP53,
directory=FOLDER,
design=~sampleCondition+batch)
ddsHTSeqMFTP53 <- ddsHTSeqMFTP53[rowSums(counts(ddsHTSeqMFTP53)) > 0, ]
ddsHTSeqMFTP53$sampleCondition <- relevel(ddsHTSeqMFTP53$sampleCondition, ref = "TP53wt")
ddsTP53 <- estimateSizeFactors(ddsHTSeqMFTP53)
vsdTP53 <- vst(ddsHTSeqMFTP53, blind=FALSE)
plotPCA(vsdTP53, intgroup=c("sampleCondition", "batch"))
ddsTP53 <- DESeq(ddsHTSeqMFTP53)
resultsNames(ddsTP53)
cat("MA Plot: Differential expression based on TP53 single-hit status in Nigerians")
resTP53singlehit <- lfcShrink(ddsTP53, coef="sampleCondition_TP53single_vs_TP53wt", type="ashr")
DESeq2::plotMA(resTP53singlehit, ylim=c(-10,10), xlim=c(0.1,200))
cat("MA Plot: Differential expression based on TP53 single-hit status in Nigerians")
resTP53singlehit <- lfcShrink(ddsTP53, coef="sampleCondition_TP53single_vs_TP53wt", type="ashr")
DESeq2::plotMA(resTP53singlehit, ylim=c(-10,10), xlim=c(0.1,200))
plotCounts(ddsTP53, gene="ENSG00000141510.11", intgroup=c("sampleCondition", "batch"), main="Distribution of TP53 expression by breast cancer subtype / hit status in TCGA white patients")
diffTP53single<- results(ddsTP53, contrast=c("sampleCondition", "TP53single", "TP53wt"), pAdjustMethod ="fdr", alpha=fdr)
diffTP53single$foldChange <- NA
row.pos <- which(! is.na(diffTP53single$log2FoldChange) &
diffTP53single$log2FoldChange >= 0)
row.neg <- which(! is.na(diffTP53single$log2FoldChange) &
diffTP53single$log2FoldChange < 0)
diffTP53single$foldChange[row.pos] <- 2^diffTP53single$log2FoldChange[row.pos]
diffTP53single$foldChange[row.neg] <- -2^((-1) * diffTP53single$log2FoldChange[row.neg])
nrow(diffTP53single)
diffTP53single <- diffTP53single[(diffTP53single$foldChange > fc | diffTP53single$foldChange < -fc),]
diffTP53single <- subset(diffTP53single, padj < fdr)
nrow(diffTP53single)
restemp <- lfcShrink(ddsTP53, contrast=c("sampleCondition", "TP53single", "TP53wt"), res = diffTP53single, type="ashr")
restemp$temp <- row.names(restemp)
restemp$temp <- gsub("[.].+", "", restemp$temp)
restemp$symbol <- mapIds(EnsDb.Hsapiens.v75,
keys=restemp$temp,
column="SYMBOL",
keytype="GENEID",
multiVals="first")
with(restemp, plot(log2FoldChange, -log10(padj), pch=20, main="Volcano plot of differential gene expression between \nbreast cancers in Nigerian patients with and without TP53 single-hit mutations", xlim=c(-60,60), ylim=c(0,60)))
with(subset(restemp, padj<0.05 & (2^(abs(log2FoldChange))>50)), points(log2FoldChange, -log10(padj), pch=20, col="blue"))
with(subset(restemp, padj<0.05 & (2^(abs(log2FoldChange))>50)), textxy(log2FoldChange, -log10(padj), labs=symbol, cex=.5))
restemp$temp <- row.names(restemp)
restemp$temp <- gsub("[.].+", "", restemp$temp)
restemp$symbol <- mapIds(EnsDb.Hsapiens.v75,
keys=restemp$temp,
column="SYMBOL",
keytype="GENEID",
multiVals="first")
with(restemp, plot(log2FoldChange, -log10(padj), pch=20, main="Volcano plot of differential gene expression between \nbreast cancers in TCGA white patients with and without TP53 single-hit mutations", xlim=c(-60,60), ylim=c(0,60)))
with(subset(restemp, padj<0.05 & (2^(abs(log2FoldChange))>50)), points(log2FoldChange, -log10(padj), pch=20, col="blue"))
with(subset(restemp, padj<0.05 & (2^(abs(log2FoldChange))>50)), textxy(log2FoldChange, -log10(padj), labs=symbol, cex=.5))
diffTP53singletable <- as.data.frame(diffTP53single)
diffTP53singletable$temp <- row.names(diffTP53single)
diffTP53singletable$temp <- gsub("[.].+", "", diffTP53singletable$temp)
diffTP53singletable$symbol <- mapIds(EnsDb.Hsapiens.v75,
keys=diffTP53singletable$temp,
column="SYMBOL",
keytype="GENEID",
multiVals="first")
diffTP53singletable$biotype <- mapIds(EnsDb.Hsapiens.v75,
keys=diffTP53singletable$temp,
column="GENEBIOTYPE",
keytype="GENEID",
multiVals="first")
diffTP53singletable$chr <- mapIds(EnsDb.Hsapiens.v75,
keys=diffTP53singletable$temp,
column="SEQNAME",
keytype="GENEID",
multiVals="first")
diffTP53singletable$locstart <- mapIds(EnsDb.Hsapiens.v75,
keys=diffTP53singletable$temp,
column="GENESEQSTART",
keytype="GENEID",
multiVals="first")
diffTP53singletable$locend <- mapIds(EnsDb.Hsapiens.v75,
keys=diffTP53singletable$temp,
column="GENESEQEND",
keytype="GENEID",
multiVals="first")
diffTP53singletable$temp <- NULL
diffTP53singletable <- diffTP53singletable %>% arrange(foldChange) %>% dplyr::filter(padj < 0.05) %>% dplyr::filter(abs(foldChange)>1.5)
top_n(diffTP53singletable, 10, foldChange)
top_n(diffTP53singletable, -10, foldChange)
diffTP53singletable$baseMean <- NULL
write.csv(diffTP53singletable, file = "RNA-DE-TCGA_white-TP53-singlehit.csv", row.names =FALSE)
diffTP53double<- results(ddsTP53, contrast=c("sampleCondition", "TP53double", "TP53wt"), pAdjustMethod ="fdr", alpha=fdr)
diffTP53double$foldChange <- NA
row.pos <- which(! is.na(diffTP53double$log2FoldChange) &
diffTP53double$log2FoldChange >= 0)
row.neg <- which(! is.na(diffTP53double$log2FoldChange) &
diffTP53double$log2FoldChange < 0)
diffTP53double$foldChange[row.pos] <- 2^diffTP53double$log2FoldChange[row.pos]
diffTP53double$foldChange[row.neg] <- -2^((-1) * diffTP53double$log2FoldChange[row.neg])
nrow(diffTP53double)
diffTP53double <- diffTP53double[(diffTP53double$foldChange > fc | diffTP53double$foldChange < -fc),]
diffTP53double <- subset(diffTP53double, padj < fdr)
nrow(diffTP53double)
restemp <- lfcShrink(ddsTP53, contrast=c("sampleCondition", "TP53double", "TP53wt"), res = diffTP53double, type="ashr")
restemp$temp <- row.names(restemp)
restemp$temp <- gsub("[.].+", "", restemp$temp)
restemp$symbol <- mapIds(EnsDb.Hsapiens.v75,
keys=restemp$temp,
column="SYMBOL",
keytype="GENEID",
multiVals="first")
with(restemp, plot(log2FoldChange, -log10(padj), pch=20, main="Volcano plot of differential gene expression between \nbreast cancers in TCGA white patients with and without TP53 double hit mutations", xlim=c(-60,60), ylim=c(0,60)))
with(subset(restemp, padj<0.05 & (2^(abs(log2FoldChange))>50)), points(log2FoldChange, -log10(padj), pch=20, col="blue"))
with(subset(restemp, padj<0.05 & (2^(abs(log2FoldChange))>50)), textxy(log2FoldChange, -log10(padj), labs=symbol, cex=.5))
diffTP53doubletable <- as.data.frame(diffTP53double)
diffTP53doubletable$temp <- row.names(diffTP53double)
diffTP53doubletable$temp <- gsub("[.].+", "", diffTP53doubletable$temp)
diffTP53doubletable$symbol <- mapIds(EnsDb.Hsapiens.v75,
keys=diffTP53doubletable$temp,
column="SYMBOL",
keytype="GENEID",
multiVals="first")
diffTP53doubletable$biotype <- mapIds(EnsDb.Hsapiens.v75,
keys=diffTP53doubletable$temp,
column="GENEBIOTYPE",
keytype="GENEID",
multiVals="first")
diffTP53doubletable$chr <- mapIds(EnsDb.Hsapiens.v75,
keys=diffTP53doubletable$temp,
column="SEQNAME",
keytype="GENEID",
multiVals="first")
diffTP53doubletable$locstart <- mapIds(EnsDb.Hsapiens.v75,
keys=diffTP53doubletable$temp,
column="GENESEQSTART",
keytype="GENEID",
multiVals="first")
diffTP53doubletable$locend <- mapIds(EnsDb.Hsapiens.v75,
keys=diffTP53doubletable$temp,
column="GENESEQEND",
keytype="GENEID",
multiVals="first")
diffTP53doubletable$temp <- NULL
diffTP53doubletable <- diffTP53doubletable %>% arrange(foldChange) %>% dplyr::filter(padj < 0.05) %>% dplyr::filter(abs(foldChange)>1.5)
top_n(diffTP53doubletable, 10, foldChange)
top_n(diffTP53doubletable, -10, foldChange)
diffTP53doubletable$baseMean <- NULL
write.csv(diffTP53doubletable, file = "RNA-DE-TCGA_white-TP53-doublehit.csv", row.names =FALSE)
sampleTableTP53 <- data.frame(sampleName=gsub(".htseq.counts","",sampleFiles),
fileName=sampleFiles,
condition1=sampleConditionrace,
condition2=sampleTP53,
batch=sampleConditionIHC)
sampleTableTP53$condition1 <- ifelse (grepl("TCGA_black",sampleTableTP53$condition1), "TCGA_black", NA)
sampleTableTP53 <- sampleTableTP53 %>% subset(is.na(sampleTableTP53$condition1)==FALSE)
sampleTableTP53$sampleCondition <- sampleTableTP53$condition2
sampleTableTP53$condition1 <- NULL
sampleTableTP53$condition2 <- NULL
ddsHTSeqMFTP53 <- DESeqDataSetFromHTSeqCount(
sampleTable=sampleTableTP53,
directory=FOLDER,
design=~sampleCondition+batch)
ddsHTSeqMFTP53 <- ddsHTSeqMFTP53[rowSums(counts(ddsHTSeqMFTP53)) > 0, ]
ddsHTSeqMFTP53$sampleCondition <- relevel(ddsHTSeqMFTP53$sampleCondition, ref = "TP53wt")
ddsTP53 <- estimateSizeFactors(ddsHTSeqMFTP53)
vsdTP53 <- vst(ddsHTSeqMFTP53, blind=FALSE)
plotPCA(vsdTP53, intgroup=c("sampleCondition", "batch"))
ddsTP53 <- DESeq(ddsHTSeqMFTP53)
resultsNames(ddsTP53)
cat("MA Plot: Differential expression based on TP53 single-hit status in TCGA black patients")
resTP53singlehit <- lfcShrink(ddsTP53, coef="sampleCondition_TP53single_vs_TP53wt", type="ashr")
DESeq2::plotMA(resTP53singlehit, ylim=c(-10,10), xlim=c(0.1,200))
plotCounts(ddsTP53, gene="ENSG00000141510.11", intgroup=c("sampleCondition", "batch"), main="Distribution of TP53 expression by breast cancer subtype / hit status in TCGA black patients")
diffTP53single<- results(ddsTP53, contrast=c("sampleCondition", "TP53single", "TP53wt"), pAdjustMethod ="fdr", alpha=fdr)
diffTP53single$foldChange <- NA
row.pos <- which(! is.na(diffTP53single$log2FoldChange) &
diffTP53single$log2FoldChange >= 0)
row.neg <- which(! is.na(diffTP53single$log2FoldChange) &
diffTP53single$log2FoldChange < 0)
diffTP53single$foldChange[row.pos] <- 2^diffTP53single$log2FoldChange[row.pos]
diffTP53single$foldChange[row.neg] <- -2^((-1) * diffTP53single$log2FoldChange[row.neg])
nrow(diffTP53single)
diffTP53single <- diffTP53single[(diffTP53single$foldChange > fc | diffTP53single$foldChange < -fc),]
diffTP53single <- subset(diffTP53single, padj < fdr)
nrow(diffTP53single)
restemp <- lfcShrink(ddsTP53, contrast=c("sampleCondition", "TP53single", "TP53wt"), res = diffTP53single, type="ashr")
restemp$temp <- row.names(restemp)
restemp$temp <- gsub("[.].+", "", restemp$temp)
restemp$symbol <- mapIds(EnsDb.Hsapiens.v75,
keys=restemp$temp,
column="SYMBOL",
keytype="GENEID",
multiVals="first")
with(restemp, plot(log2FoldChange, -log10(padj), pch=20, main="Volcano plot of differential gene expression between \nbreast cancers in TCGA black patients with and without TP53 single-hit mutations", xlim=c(-60,60), ylim=c(0,60)))
with(subset(restemp, padj<0.05 & (2^(abs(log2FoldChange))>50)), points(log2FoldChange, -log10(padj), pch=20, col="blue"))
with(subset(restemp, padj<0.05 & (2^(abs(log2FoldChange))>50)), textxy(log2FoldChange, -log10(padj), labs=symbol, cex=.5))
diffTP53singletable <- as.data.frame(diffTP53single)
diffTP53singletable$temp <- row.names(diffTP53single)
diffTP53singletable$temp <- gsub("[.].+", "", diffTP53singletable$temp)
diffTP53singletable$symbol <- mapIds(EnsDb.Hsapiens.v75,
keys=diffTP53singletable$temp,
column="SYMBOL",
keytype="GENEID",
multiVals="first")
diffTP53singletable$biotype <- mapIds(EnsDb.Hsapiens.v75,
keys=diffTP53singletable$temp,
column="GENEBIOTYPE",
keytype="GENEID",
multiVals="first")
diffTP53singletable$chr <- mapIds(EnsDb.Hsapiens.v75,
keys=diffTP53singletable$temp,
column="SEQNAME",
keytype="GENEID",
multiVals="first")
diffTP53singletable$locstart <- mapIds(EnsDb.Hsapiens.v75,
keys=diffTP53singletable$temp,
column="GENESEQSTART",
keytype="GENEID",
multiVals="first")
diffTP53singletable$locend <- mapIds(EnsDb.Hsapiens.v75,
keys=diffTP53singletable$temp,
column="GENESEQEND",
keytype="GENEID",
multiVals="first")
diffTP53singletable$temp <- NULL
diffTP53singletable <- diffTP53singletable %>% arrange(foldChange) %>% dplyr::filter(padj < 0.05) %>% dplyr::filter(abs(foldChange)>1.5)
top_n(diffTP53singletable, 10, foldChange)
top_n(diffTP53singletable, -10, foldChange)
diffTP53singletable$baseMean <- NULL
write.csv(diffTP53singletable, file = "RNA-DE-TCGA_black-TP53-singlehit.csv", row.names =FALSE)
