<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Padma Sheila Rajagopal, MD MPH" />


<title>Nigerian-TCGA Differential Expression Analysis Using DeSeq2 - Protein Coding Genes Only</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/spacelab.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<div class="container-fluid main-container">

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->



<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Olopade Lab: TCGA-Nigerian-RNAseq Project</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="NigerianTCGArawcountsDeSeq2.html">Differential Expression Analysis</a>
</li>
<li>
  <a href="NigerianTCGArawcountsDeSeq2-proteincoding.html">Protein-Coding Only DE Analysis</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/parajago/TCGA-Nigerian-RNAseq">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Nigerian-TCGA Differential Expression Analysis Using DeSeq2 - Protein Coding Genes Only</h1>
<h4 class="author"><em>Padma Sheila Rajagopal, MD MPH</em></h4>
<h4 class="date"><em>3/10/2019</em></h4>

</div>


<p><strong>Last updated:</strong> 2019-03-10</p>
<strong>workflowr checks:</strong> <small>(Click a bullet for more information)</small>
<ul>
<li>
<p><details> <summary> <strong style="color:red;">✖</strong> <strong>R Markdown file:</strong> uncommitted changes </summary> The R Markdown file has unstaged changes. To know which version of the R Markdown file created these results, you’ll want to first commit it to the Git repo. If you’re still working on the analysis, you can ignore this warning. When you’re finished, you can run <code>wflow_publish</code> to commit the R Markdown file and build the HTML.</p>
</details>
</li>
<li>
<p><details> <summary> <strong style="color:blue;">✔</strong> <strong>Environment:</strong> empty </summary></p>
<p>Great job! The global environment was empty. Objects defined in the global environment can affect the analysis in your R Markdown file in unknown ways. For reproduciblity it’s best to always run the code in an empty environment.</p>
</details>
</li>
<li>
<p><details> <summary> <strong style="color:blue;">✔</strong> <strong>Seed:</strong> <code>set.seed(20190113)</code> </summary></p>
<p>The command <code>set.seed(20190113)</code> was run prior to running the code in the R Markdown file. Setting a seed ensures that any results that rely on randomness, e.g. subsampling or permutations, are reproducible.</p>
</details>
</li>
<li>
<p><details> <summary> <strong style="color:blue;">✔</strong> <strong>Session information:</strong> recorded </summary></p>
<p>Great job! Recording the operating system, R version, and package versions is critical for reproducibility.</p>
</details>
</li>
<li>
<p><details> <summary> <strong style="color:blue;">✔</strong> <strong>Repository version:</strong> <a href="https://github.com/parajago/TCGA-Nigerian-RNAseq/tree/b1db0c20903161efc5a704a9efbdafba5741fb31" target="_blank">b1db0c2</a> </summary></p>
Great! You are using Git for version control. Tracking code development and connecting the code version to the results is critical for reproducibility. The version displayed above was the version of the Git repository at the time these results were generated. <br><br> Note that you need to be careful to ensure that all relevant files for the analysis have been committed to Git prior to generating the results (you can use <code>wflow_publish</code> or <code>wflow_git_commit</code>). workflowr only checks the R Markdown file, but you know if there are other scripts or data files that it depends on. Below is the status of the Git repository when the results were generated:
<pre><code>
Ignored files:
    Ignored:    .DS_Store
    Ignored:    .Rproj.user/
    Ignored:    analysis/.DS_Store
    Ignored:    analysis/NigerianTCGArawcountsDeSeq2-proteincoding_cache/
    Ignored:    code/.DS_Store
    Ignored:    docs/.DS_Store
    Ignored:    docs/figure/.DS_Store
    Ignored:    plots/.DS_Store

Untracked files:
    Untracked:  analysis/figure/

Unstaged changes:
    Modified:   analysis/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd
    Modified:   code/proteincodingparse.Rmd

</code></pre>
Note that any generated files, e.g. HTML, png, CSS, etc., are not included in this status report because it is ok for generated content to have uncommitted changes. </details>
</li>
</ul>
<details> <summary> <small><strong>Expand here to see past versions:</strong></small> </summary>
<ul>
<table style="border-collapse:separate; border-spacing:5px;">
<thead>
<tr>
<th style="text-align:left;">
File
</th>
<th style="text-align:left;">
Version
</th>
<th style="text-align:left;">
Author
</th>
<th style="text-align:left;">
Date
</th>
<th style="text-align:left;">
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Rmd
</td>
<td style="text-align:left;">
<a href="https://github.com/parajago/TCGA-Nigerian-RNAseq/blob/303135894e957747263e7211bf29d9d74eacdbbc/analysis/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd" target="_blank">3031358</a>
</td>
<td style="text-align:left;">
Sheila Rajagopal
</td>
<td style="text-align:left;">
2019-03-06
</td>
<td style="text-align:left;">
Analysis repeated with protein coding only
</td>
</tr>
<tr>
<td style="text-align:left;">
html
</td>
<td style="text-align:left;">
<a href="https://cdn.rawgit.com/parajago/TCGA-Nigerian-RNAseq/303135894e957747263e7211bf29d9d74eacdbbc/docs/NigerianTCGArawcountsDeSeq2-proteincoding.html" target="_blank">3031358</a>
</td>
<td style="text-align:left;">
Sheila Rajagopal
</td>
<td style="text-align:left;">
2019-03-06
</td>
<td style="text-align:left;">
Analysis repeated with protein coding only
</td>
</tr>
</tbody>
</table>
</ul>
<p></details></p>
<hr />
<div id="translation-from-htseq---deseq2-table" class="section level1">
<h1>Translation from HTSeq -&gt; DESeq2 table</h1>
<p>I have 86 TCGA patients with whole-genome sequencing data and RNAseq data as well as 99 Nigerian patients with RNA-seq data. Raw counts were initially processed using HTSeq, so HTSeq data is being formatted for use with DESeq2.</p>
<pre class="r"><code>FOLDER &lt;- &quot;/Users/parajago/Research-Local/RNAseq-Local/Inputs/NigerianTCGA_quants-proteincoding&quot;
sampleFiles &lt;- grep(&quot;htseq.counts&quot;,list.files(FOLDER),value=TRUE)

#Differential gene expression setup based on race (b/w/other)
sampleConditionrace &lt;- sampleFiles
countVar2=1
for (sample in sampleConditionrace){
  if (stri_detect_fixed(sample,&quot;LIB&quot;)==TRUE){
    sampleConditionrace[countVar2] &lt;- &quot;Nigerian&quot;
    countVar2=countVar2+1
  } else if (stri_detect_fixed(sample,&quot;black&quot;)==TRUE){
    sampleConditionrace[countVar2] &lt;- &quot;TCGA_black&quot;
    countVar2=countVar2+1
  } else if (stri_detect_fixed(sample,&quot;white&quot;)==TRUE){
    sampleConditionrace[countVar2] &lt;- &quot;TCGA_white&quot;
    countVar2=countVar2+1
  } else{
    sampleConditionrace[countVar2] &lt;- &quot;TCGA_other&quot;
    countVar2=countVar2+1
  }
}

#Condition based on PAM50 subtype 
sampleConditionPAM50 &lt;- sampleFiles
countVar2=1
for (sample in sampleConditionPAM50){
  if (stri_detect_fixed(sample,&quot;Her2&quot;)==TRUE){
    sampleConditionPAM50[countVar2] &lt;- &quot;Her2&quot;
    countVar2=countVar2+1
  } else if (stri_detect_fixed(sample,&quot;Basal&quot;)==TRUE){
    sampleConditionPAM50[countVar2] &lt;- &quot;Basal&quot;
    countVar2=countVar2+1
  } else if (stri_detect_fixed(sample,&quot;LumA&quot;)==TRUE){
    sampleConditionPAM50[countVar2] &lt;- &quot;LumA&quot;
    countVar2=countVar2+1
  } else if (stri_detect_fixed(sample,&quot;LumB&quot;)==TRUE){
    sampleConditionPAM50[countVar2] &lt;- &quot;LumB&quot;
    countVar2=countVar2+1
  } else if (stri_detect_fixed(sample,&quot;PAMNL&quot;)==TRUE){
    sampleConditionPAM50[countVar2] &lt;- &quot;Normal&quot;
    countVar2=countVar2+1
  } else{
    sampleConditionPAM50[countVar2] &lt;- &quot;PAM_other&quot;
    countVar2=countVar2+1
  }
}

#Condition based on batch (relevant to the Nigerian patients only; no difference in batch for the TCGA patients)
batchval &lt;- sampleFiles
countVar2=1
for (sample in batchval){
  if (stri_detect_fixed(sample,&quot;batch1&quot;)==TRUE){
    batchval[countVar2] &lt;- &quot;batch1&quot;
    countVar2=countVar2+1
  } else if (stri_detect_fixed(sample,&quot;batch23&quot;)==TRUE){
    batchval[countVar2] &lt;- &quot;batch23&quot;
    countVar2=countVar2+1
  } else if (stri_detect_fixed(sample,&quot;batch4&quot;)==TRUE){
    batchval[countVar2] &lt;- &quot;batch4&quot;
    countVar2=countVar2+1
  } else if (stri_detect_fixed(sample,&quot;batch5&quot;)==TRUE){
    batchval[countVar2] &lt;- &quot;batch5&quot;
    countVar2=countVar2+1
  } else{
    batchval[countVar2] &lt;- &quot;batchT&quot;
    countVar2=countVar2+1
  }
}

table(sampleConditionrace, sampleConditionPAM50)</code></pre>
<pre><code>                   sampleConditionPAM50
sampleConditionrace Basal Her2 LumA LumB Normal PAM_other
         Nigerian      32   26   16   18      7         0
         TCGA_black    25    0    4    4      0         0
         TCGA_other     0    0    0    0      0        14
         TCGA_white    17    5    8    9      0         0</code></pre>
<pre class="r"><code>sampleTable2 &lt;- data.frame(sampleName=gsub(&quot;.htseq.counts&quot;,&quot;&quot;,sampleFiles),
                          fileName=sampleFiles,
                          condition1=sampleConditionrace,
                          condition2=sampleConditionPAM50,
                          batch=batchval)

sampleTable2$sampleCondition &lt;- paste(sampleTable2$condition1, sampleTable2$condition2, sep=&quot;.&quot;)

ddsHTSeqMF &lt;- DESeqDataSetFromHTSeqCount(sampleTable=sampleTable2,
                                       directory=FOLDER,
                                       design=~sampleCondition)</code></pre>
</div>
<div id="variance-transformation-batch-effect-assessment-and-initial-exploratory-analysis" class="section level1">
<h1>Variance transformation, batch effect assessment and initial exploratory analysis</h1>
<p>I am now performing different visualization approaches to assess the variance of the data, batch effect and expected differences between the two populations.</p>
<pre class="r"><code>ddsHTSeqMF &lt;- ddsHTSeqMF[rowSums(counts(ddsHTSeqMF)) &gt; 1, ] #Pre-filtering the dataset by removing the rows without information about gene expression

dds &lt;- estimateSizeFactors(ddsHTSeqMF) #The size factor is the median ratio of the sample over a &quot;pseudosample&quot;: for each gene, the geometric mean of all samples.
dds$sampleCondition &lt;- relevel(dds$sampleCondition, ref = &quot;Nigerian.Basal&quot;) #explicitly making the Nigerian Basal patients the reference population

vsd &lt;- vst(ddsHTSeqMF, blind = TRUE) #Variance-stabilizing transformation

df &lt;- bind_rows( #Graphical representation of the variance-stabilizing transformation
          as_data_frame(log2(counts(dds, normalized=TRUE)[, 1:2]+1)) %&gt;%
          mutate(transformation = &quot;log2(x + 1)&quot;),
          as_data_frame(assay(vsd)[, 1:2]) %&gt;% mutate(transformation = &quot;vst&quot;))
          colnames(df)[1:2] &lt;- c(&quot;x&quot;, &quot;y&quot;)

ggplot(df, aes(x = x, y = y)) + geom_hex(bins = 80) + coord_fixed() + facet_grid( . ~ transformation)</code></pre>
<p><img src="figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/Variance%20transformation%20and%20batch%20effect%20assessment-1.png" width="672" style="display: block; margin: auto;" /></p>
<details> <summary><em>Expand here to see past versions of Variance transformation and batch effect assessment-1.png:</em></summary>
<table style="border-collapse:separate; border-spacing:5px;">
<thead>
<tr>
<th style="text-align:left;">
Version
</th>
<th style="text-align:left;">
Author
</th>
<th style="text-align:left;">
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<a href="https://github.com/parajago/TCGA-Nigerian-RNAseq/blob/303135894e957747263e7211bf29d9d74eacdbbc/docs/figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/Variance transformation and batch effect assessment-1.png" target="_blank">3031358</a>
</td>
<td style="text-align:left;">
Sheila Rajagopal
</td>
<td style="text-align:left;">
2019-03-06
</td>
</tr>
</tbody>
</table>
<p></details></p>
<p>Figure 1: Graphical representation of the variance-stabilizing transformation relative to the standard transformation of log2(x+1).This reduces variance purely due to low read counts</p>
<pre class="r"><code>#PCAs at this point of the analysis are all of the HTSeq-input raw counts
plotPCA(vsd, intgroup=c(&quot;condition1&quot;, &quot;batch&quot;)) </code></pre>
<p><img src="figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/Batch%20effect%20assessment-PCAs-1-1.png" width="672" style="display: block; margin: auto;" /></p>
<details> <summary><em>Expand here to see past versions of Batch effect assessment-PCAs-1-1.png:</em></summary>
<table style="border-collapse:separate; border-spacing:5px;">
<thead>
<tr>
<th style="text-align:left;">
Version
</th>
<th style="text-align:left;">
Author
</th>
<th style="text-align:left;">
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<a href="https://github.com/parajago/TCGA-Nigerian-RNAseq/blob/303135894e957747263e7211bf29d9d74eacdbbc/docs/figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/Batch effect assessment-PCAs-1-1.png" target="_blank">3031358</a>
</td>
<td style="text-align:left;">
Sheila Rajagopal
</td>
<td style="text-align:left;">
2019-03-06
</td>
</tr>
</tbody>
</table>
<p></details></p>
<p>PCA 1-1:PCA demonstrating the raw difference between Nigerian and TCGA patients, which would be expected given that these experiments were done in different settings at different times. Nigerian patients do not appear to have significant differneces based on their batches. (TCGA patients are known not to have significant difference based on batch performed.) However, there does appear to be some clustering mechanism that is separating these TCGA patients into two groups that is not race dependent.</p>
<pre class="r"><code>plotPCA(vsd, intgroup=c(&quot;condition2&quot;))</code></pre>
<p><img src="figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/Batch%20effect%20assessment-PCAs-2-1.png" width="672" style="display: block; margin: auto;" /></p>
<details> <summary><em>Expand here to see past versions of Batch effect assessment-PCAs-2-1.png:</em></summary>
<table style="border-collapse:separate; border-spacing:5px;">
<thead>
<tr>
<th style="text-align:left;">
Version
</th>
<th style="text-align:left;">
Author
</th>
<th style="text-align:left;">
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<a href="https://github.com/parajago/TCGA-Nigerian-RNAseq/blob/303135894e957747263e7211bf29d9d74eacdbbc/docs/figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/Batch effect assessment-PCAs-2-1.png" target="_blank">3031358</a>
</td>
<td style="text-align:left;">
Sheila Rajagopal
</td>
<td style="text-align:left;">
2019-03-06
</td>
</tr>
</tbody>
</table>
<p></details></p>
<p>PCA 1-2:PCA demonstrating association with breast cancer subtype and gene expression. This is noted in both groups and not likely due to batch effect given known biology.</p>
<pre class="r"><code>plotPCA(vsd, intgroup=c(&quot;condition1&quot;, &quot;condition2&quot;))</code></pre>
<p><img src="figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/Batch%20effect%20assessment-PCAs-3-1.png" width="672" style="display: block; margin: auto;" /></p>
<details> <summary><em>Expand here to see past versions of Batch effect assessment-PCAs-3-1.png:</em></summary>
<table style="border-collapse:separate; border-spacing:5px;">
<thead>
<tr>
<th style="text-align:left;">
Version
</th>
<th style="text-align:left;">
Author
</th>
<th style="text-align:left;">
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<a href="https://github.com/parajago/TCGA-Nigerian-RNAseq/blob/303135894e957747263e7211bf29d9d74eacdbbc/docs/figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/Batch effect assessment-PCAs-3-1.png" target="_blank">3031358</a>
</td>
<td style="text-align:left;">
Sheila Rajagopal
</td>
<td style="text-align:left;">
2019-03-06
</td>
</tr>
</tbody>
</table>
<p></details></p>
<p>PCA 1-3: Integrated PCA demonstrating combined effect of breast cancer subtype and race. Subtype appears to account for the clustering seen in the TCGA group.</p>
<pre class="r"><code>#Heatmap to assess clusters pre-analysis
topVarGenes &lt;- head(order(rowVars(assay(vsd)), decreasing = TRUE), 100)
hm  &lt;- assay(vsd)[ topVarGenes, ]
hm  &lt;- hm - rowMeans(hm)
anno &lt;- as.data.frame(colData(vsd)[, c(&quot;condition1&quot;, &quot;condition2&quot;)])
rownames(anno) &lt;- colnames(vsd)
pheatmap(hm, annotation_col = anno, cluster_rows=TRUE, cluster_cols=TRUE, clustering_distance_rows = &quot;euclidean&quot;, clustering_distance_cols = &quot;euclidean&quot;, clustering_method = &quot;complete&quot;, show_rownames=FALSE, show_colnames = FALSE, main=&quot;Heat map: Relative VST-transformed\ncounts across samples before batch correction&quot;)</code></pre>
<p><img src="figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/Heatmap%20to%20assess%20clusters%20pre-analysis-1.png" width="672" style="display: block; margin: auto;" /></p>
<details> <summary><em>Expand here to see past versions of Heatmap to assess clusters pre-analysis-1.png:</em></summary>
<table style="border-collapse:separate; border-spacing:5px;">
<thead>
<tr>
<th style="text-align:left;">
Version
</th>
<th style="text-align:left;">
Author
</th>
<th style="text-align:left;">
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<a href="https://github.com/parajago/TCGA-Nigerian-RNAseq/blob/303135894e957747263e7211bf29d9d74eacdbbc/docs/figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/Heatmap to assess clusters pre-analysis-1.png" target="_blank">3031358</a>
</td>
<td style="text-align:left;">
Sheila Rajagopal
</td>
<td style="text-align:left;">
2019-03-06
</td>
</tr>
</tbody>
</table>
<p></details></p>
<p>Heatmap 1-1: This heatmaps is only using the top 100 genes and is competely heirarchically clustered. These clusters appear consistent with the PCA results.</p>
<pre class="r"><code>#PCA2: Removing the batch effect created by the separate batch processing of the TCGA and Nigerian samples (although this may overcorrect for the actual difference between these two populations).  
mat &lt;- assay(vsd) 
mat &lt;- limma::removeBatchEffect(mat, vsd$condition1, vsd$batch)</code></pre>
<pre><code>Coefficients not estimable: batch24 </code></pre>
<pre class="r"><code>assay(vsd) &lt;- mat
plotPCA(vsd, intgroup=c(&quot;condition1&quot;, &quot;condition2&quot;))</code></pre>
<p><img src="figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/Batch%20effect%20assessment-PCAs-4-1.png" width="672" style="display: block; margin: auto;" /></p>
<details> <summary><em>Expand here to see past versions of Batch effect assessment-PCAs-4-1.png:</em></summary>
<table style="border-collapse:separate; border-spacing:5px;">
<thead>
<tr>
<th style="text-align:left;">
Version
</th>
<th style="text-align:left;">
Author
</th>
<th style="text-align:left;">
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<a href="https://github.com/parajago/TCGA-Nigerian-RNAseq/blob/303135894e957747263e7211bf29d9d74eacdbbc/docs/figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/Batch effect assessment-PCAs-4-1.png" target="_blank">3031358</a>
</td>
<td style="text-align:left;">
Sheila Rajagopal
</td>
<td style="text-align:left;">
2019-03-06
</td>
</tr>
</tbody>
</table>
<p></details></p>
<p>PCA 2-1: We have accounted for batch effect in this PCA only using the limma removeBatchEffect method.This largely accounts for the batch effect noticed in PCA1-Nigerian vs TCGA. There remain some outliers, primarily from the Nigerian patients.</p>
<pre class="r"><code>#Heatmap to assess clusters post-analysis
topVarGenes &lt;- head(order(rowVars(assay(vsd)), decreasing = TRUE), 100)
hm  &lt;- assay(vsd)[ topVarGenes, ]
hm  &lt;- hm - rowMeans(hm)
anno &lt;- as.data.frame(colData(vsd)[, c(&quot;condition1&quot;, &quot;condition2&quot;)])
rownames(anno) &lt;- colnames(vsd)
pheatmap(hm, annotation_col = anno, cluster_rows=TRUE, cluster_cols=TRUE, clustering_distance_rows = &quot;euclidean&quot;, clustering_distance_cols = &quot;euclidean&quot;, clustering_method = &quot;complete&quot;, show_rownames=FALSE, show_colnames = FALSE, main=&quot;Heat map: Relative VST-transformed\ncounts across samples after batch correction&quot;)</code></pre>
<p><img src="figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/Heatmap%20to%20assess%20clusters%20after%20batch%20correction-1.png" width="672" style="display: block; margin: auto;" /></p>
<details> <summary><em>Expand here to see past versions of Heatmap to assess clusters after batch correction-1.png:</em></summary>
<table style="border-collapse:separate; border-spacing:5px;">
<thead>
<tr>
<th style="text-align:left;">
Version
</th>
<th style="text-align:left;">
Author
</th>
<th style="text-align:left;">
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<a href="https://github.com/parajago/TCGA-Nigerian-RNAseq/blob/303135894e957747263e7211bf29d9d74eacdbbc/docs/figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/Heatmap to assess clusters after batch correction-1.png" target="_blank">3031358</a>
</td>
<td style="text-align:left;">
Sheila Rajagopal
</td>
<td style="text-align:left;">
2019-03-06
</td>
</tr>
</tbody>
</table>
<p></details></p>
<p>Heatmap 2-1: This heatmap after batch correction with limma’s removeBatchEffect method is only using the top 100 genes and is competely heirarchically clustered. These clusters appear consistent with the PCA results as well with clustering enabled between the breast cancer subtypes and finer interspersing of the Nigerian vs. TCGA characteristic based on breast cancer subtype.</p>
<pre class="r"><code>boxplot(log2(counts(dds)), las=2, ylab=&quot;log2(Raw Counts)&quot;, xlab=&quot;Samples&quot;, main=&quot;Boxplot of raw counts before\n batch correction/transformation&quot;)</code></pre>
<p><img src="figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/:%20Boxplots%20of%20counts%20before%20and%20after%20DESeq2%20normalization-1.png" width="672" style="display: block; margin: auto;" /></p>
<details> <summary><em>Expand here to see past versions of : Boxplots of counts before and after DESeq2 normalization-1.png:</em></summary>
<table style="border-collapse:separate; border-spacing:5px;">
<thead>
<tr>
<th style="text-align:left;">
Version
</th>
<th style="text-align:left;">
Author
</th>
<th style="text-align:left;">
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<a href="https://github.com/parajago/TCGA-Nigerian-RNAseq/blob/303135894e957747263e7211bf29d9d74eacdbbc/docs/figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/: Boxplots of counts before and after DESeq2 normalization-1.png" target="_blank">3031358</a>
</td>
<td style="text-align:left;">
Sheila Rajagopal
</td>
<td style="text-align:left;">
2019-03-06
</td>
</tr>
</tbody>
</table>
<p></details></p>
<pre class="r"><code>boxplot(log2(counts(dds, normalized=TRUE)), las=2, ylab=&quot;log2(Raw Counts)&quot;, xlab=&quot;Samples&quot;, main=&quot;Boxplot of batch corrected/transformed counts&quot;)</code></pre>
<p><img src="figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/:%20Boxplots%20of%20counts%20before%20and%20after%20DESeq2%20normalization-2.png" width="672" style="display: block; margin: auto;" /></p>
<details> <summary><em>Expand here to see past versions of : Boxplots of counts before and after DESeq2 normalization-2.png:</em></summary>
<table style="border-collapse:separate; border-spacing:5px;">
<thead>
<tr>
<th style="text-align:left;">
Version
</th>
<th style="text-align:left;">
Author
</th>
<th style="text-align:left;">
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<a href="https://github.com/parajago/TCGA-Nigerian-RNAseq/blob/303135894e957747263e7211bf29d9d74eacdbbc/docs/figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/: Boxplots of counts before and after DESeq2 normalization-2.png" target="_blank">3031358</a>
</td>
<td style="text-align:left;">
Sheila Rajagopal
</td>
<td style="text-align:left;">
2019-03-06
</td>
</tr>
</tbody>
</table>
<p></details></p>
<p>These boxplots demonstrate the effect of the DESeq2 normalization process. The normalized DESeq2 values are incorporated into the batch corrected model (as below).</p>
</div>
<div id="using-sva-to-account-for-batch-effect-related-to-the-nigeriantcga-samples" class="section level1">
<h1>Using sva to account for batch effect related to the Nigerian/TCGA samples</h1>
<pre class="r"><code>dat  &lt;- counts(dds, normalized = TRUE)
idx  &lt;- rowMeans(dat) &gt; 1
dat  &lt;- dat[idx, ]
mod  &lt;- model.matrix(~condition1, colData(dds))
mod0 &lt;- model.matrix(~   1, colData(dds))
svseq &lt;- svaseq(dat, mod, mod0, n.sv = 2)</code></pre>
<pre><code>Number of significant surrogate variables is:  2 
Iteration (out of 5 ):1  2  3  4  5  </code></pre>
<pre class="r"><code>sampleTablebe &lt;- data.frame(sampleName=gsub(&quot;.htseq.counts&quot;,&quot;&quot;,sampleFiles),
                          fileName=sampleFiles,
                          condition1=sampleConditionrace,
                          condition2=sampleConditionPAM50,
                          be1=svseq$sv[,1],
                          be2=svseq$sv[,2],
                          batch=batchval)

sampleTablebe$sampleCondition &lt;- paste(sampleTablebe$condition1, sampleTablebe$condition2, sep=&quot;.&quot;)

ddsHTSeqMFbe &lt;- DESeqDataSetFromHTSeqCount(sampleTable=sampleTablebe,
                                       directory=FOLDER,
                                       design=~sampleCondition + be1 + be2)

ddsHTSeqMFbe &lt;- ddsHTSeqMFbe[rowSums(counts(ddsHTSeqMFbe)) &gt; 1, ]</code></pre>
</div>
<div id="differential-expression-analysis" class="section level1">
<h1>Differential expression analysis</h1>
<p>This is the actual differential expression analysis with false discovery threshold of 0.05. I am performing this for both the standard and batch-effect-corrected versions of the DESeq2 model to allow comparison.</p>
<pre class="r"><code>ddsMF &lt;- DESeq(ddsHTSeqMF) #This will refer to a version that does not include batch correction outside of what is accomplished through DESeq2 alone. 
ddsMFbe &lt;-DESeq(ddsHTSeqMFbe) 
#70 rows did not converge in beta, labelled in mcols(object)$betaConv

resultsNames(ddsMF)</code></pre>
<pre><code> [1] &quot;Intercept&quot;                                             
 [2] &quot;sampleCondition_Nigerian.Her2_vs_Nigerian.Basal&quot;       
 [3] &quot;sampleCondition_Nigerian.LumA_vs_Nigerian.Basal&quot;       
 [4] &quot;sampleCondition_Nigerian.LumB_vs_Nigerian.Basal&quot;       
 [5] &quot;sampleCondition_Nigerian.Normal_vs_Nigerian.Basal&quot;     
 [6] &quot;sampleCondition_TCGA_black.Basal_vs_Nigerian.Basal&quot;    
 [7] &quot;sampleCondition_TCGA_black.LumA_vs_Nigerian.Basal&quot;     
 [8] &quot;sampleCondition_TCGA_black.LumB_vs_Nigerian.Basal&quot;     
 [9] &quot;sampleCondition_TCGA_other.PAM_other_vs_Nigerian.Basal&quot;
[10] &quot;sampleCondition_TCGA_white.Basal_vs_Nigerian.Basal&quot;    
[11] &quot;sampleCondition_TCGA_white.Her2_vs_Nigerian.Basal&quot;     
[12] &quot;sampleCondition_TCGA_white.LumA_vs_Nigerian.Basal&quot;     
[13] &quot;sampleCondition_TCGA_white.LumB_vs_Nigerian.Basal&quot;     </code></pre>
<pre class="r"><code>resultsNames(ddsMFbe)</code></pre>
<pre><code> [1] &quot;Intercept&quot;                                             
 [2] &quot;sampleCondition_Nigerian.Her2_vs_Nigerian.Basal&quot;       
 [3] &quot;sampleCondition_Nigerian.LumA_vs_Nigerian.Basal&quot;       
 [4] &quot;sampleCondition_Nigerian.LumB_vs_Nigerian.Basal&quot;       
 [5] &quot;sampleCondition_Nigerian.Normal_vs_Nigerian.Basal&quot;     
 [6] &quot;sampleCondition_TCGA_black.Basal_vs_Nigerian.Basal&quot;    
 [7] &quot;sampleCondition_TCGA_black.LumA_vs_Nigerian.Basal&quot;     
 [8] &quot;sampleCondition_TCGA_black.LumB_vs_Nigerian.Basal&quot;     
 [9] &quot;sampleCondition_TCGA_other.PAM_other_vs_Nigerian.Basal&quot;
[10] &quot;sampleCondition_TCGA_white.Basal_vs_Nigerian.Basal&quot;    
[11] &quot;sampleCondition_TCGA_white.Her2_vs_Nigerian.Basal&quot;     
[12] &quot;sampleCondition_TCGA_white.LumA_vs_Nigerian.Basal&quot;     
[13] &quot;sampleCondition_TCGA_white.LumB_vs_Nigerian.Basal&quot;     
[14] &quot;be1&quot;                                                   
[15] &quot;be2&quot;                                                   </code></pre>
<pre class="r"><code>#MAPlot: log2 fold changes attributable to the condition over the mean of normalized counts for all the samples in the DESeqDataSet. Points will be colored red if the adjusted p value is less than 0.1. Points which fall out of the window are plotted as open triangles pointing either up or down.
cat(&quot;MA Plot 1: Original differential expression&quot;)</code></pre>
<pre><code>MA Plot 1: Original differential expression</code></pre>
<pre class="r"><code>res &lt;- lfcShrink(ddsMF, coef=&quot;sampleCondition_TCGA_white.Basal_vs_Nigerian.Basal&quot;, type=&quot;ashr&quot;, optmethod = &quot;mixEM&quot;)
DESeq2::plotMA(res, ylim=c(-10,10), xlim=c(0.1,200))</code></pre>
<p><img src="figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/Differential%20expression%20analysis%20and%20visualization-1.png" width="672" style="display: block; margin: auto;" /></p>
<details> <summary><em>Expand here to see past versions of Differential expression analysis and visualization-1.png:</em></summary>
<table style="border-collapse:separate; border-spacing:5px;">
<thead>
<tr>
<th style="text-align:left;">
Version
</th>
<th style="text-align:left;">
Author
</th>
<th style="text-align:left;">
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<a href="https://github.com/parajago/TCGA-Nigerian-RNAseq/blob/303135894e957747263e7211bf29d9d74eacdbbc/docs/figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/Differential expression analysis and visualization-1.png" target="_blank">3031358</a>
</td>
<td style="text-align:left;">
Sheila Rajagopal
</td>
<td style="text-align:left;">
2019-03-06
</td>
</tr>
</tbody>
</table>
<p></details></p>
<pre class="r"><code>cat(&quot;MA Plot 2: Batch-corrected differential expression&quot;)</code></pre>
<pre><code>MA Plot 2: Batch-corrected differential expression</code></pre>
<pre class="r"><code>res2 &lt;- lfcShrink(ddsMFbe, coef=&quot;sampleCondition_TCGA_white.Basal_vs_Nigerian.Basal&quot;, type=&quot;ashr&quot; , optmethod = &quot;mixEM&quot;)
DESeq2::plotMA(res2, ylim=c(-10,10), xlim=c(0.1,200))</code></pre>
<p><img src="figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/Differential%20expression%20analysis%20and%20visualization-2.png" width="672" style="display: block; margin: auto;" /></p>
<details> <summary><em>Expand here to see past versions of Differential expression analysis and visualization-2.png:</em></summary>
<table style="border-collapse:separate; border-spacing:5px;">
<thead>
<tr>
<th style="text-align:left;">
Version
</th>
<th style="text-align:left;">
Author
</th>
<th style="text-align:left;">
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<a href="https://github.com/parajago/TCGA-Nigerian-RNAseq/blob/303135894e957747263e7211bf29d9d74eacdbbc/docs/figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/Differential expression analysis and visualization-2.png" target="_blank">3031358</a>
</td>
<td style="text-align:left;">
Sheila Rajagopal
</td>
<td style="text-align:left;">
2019-03-06
</td>
</tr>
</tbody>
</table>
<p></details></p>
<p>This is just an MA-plot demonstration of the efficacy of the batch effect correction (using TCGA-white basal breast cancer patients vs Nigerian basal breast cancer patients as an example). The second MA plot with batch-corrected differential expression looks like it is more appropriately assessing significantly differentially expressed genes between these two populations.</p>
<p>This is a check between the TCGA black and white patients to verify this differential expression analysis based on prior work by Stewart et al (PLOS One 2013) and Huo et al (JAMA Oncology 2017). This was only performed with the basal patients as this was the largest subsample.</p>
<pre class="r"><code>diffTCGA&lt;- results(ddsMFbe, contrast=c(&quot;sampleCondition&quot;, &quot;TCGA_black.Basal&quot;, &quot;TCGA_white.Basal&quot;), alpha=0.05)

restemp &lt;- results(ddsMFbe, contrast=c(&quot;sampleCondition&quot;, &quot;TCGA_black.Basal&quot;, &quot;TCGA_white.Basal&quot;), alpha=0.05)
restemp &lt;- lfcShrink(ddsMFbe, contrast=c(&quot;sampleCondition&quot;, &quot;TCGA_black.Basal&quot;, &quot;TCGA_white.Basal&quot;), res = restemp, type=&quot;ashr&quot;, optmethod = &quot;mixEM&quot;)

diffTCGA &lt;- subset(diffTCGA, padj &lt; 0.05) #Selecting only the lowest threshold of significant findings
diffTCGA$temp &lt;- row.names(diffTCGA)
diffTCGA$temp &lt;- gsub(&quot;[.].+&quot;, &quot;&quot;, diffTCGA$temp)

restemp$temp &lt;- row.names(restemp)
restemp$temp &lt;- gsub(&quot;[.].+&quot;, &quot;&quot;, restemp$temp)

diffTCGA$symbol &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=diffTCGA$temp,
                     column=&quot;SYMBOL&quot;,
                     keytype=&quot;GENEID&quot;,           
                     multiVals=&quot;first&quot;)

restemp$symbol &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=restemp$temp,
                     column=&quot;SYMBOL&quot;,
                     keytype=&quot;GENEID&quot;,           
                     multiVals=&quot;first&quot;)

diffTCGA$chr &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=diffTCGA$temp,
                     column=&quot;SEQNAME&quot;,
                     keytype=&quot;GENEID&quot;,           
                     multiVals=&quot;first&quot;)

diffTCGA$locstart &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=diffTCGA$temp,
                     column=&quot;GENESEQSTART&quot;,
                     keytype=&quot;GENEID&quot;,
                     multiVals=&quot;first&quot;)

diffTCGA$locend &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=diffTCGA$temp,
                     column=&quot;GENESEQEND&quot;,
                     keytype=&quot;GENEID&quot;,
                     multiVals=&quot;first&quot;)

hist(restemp$pvalue, main=&quot;Histogram of unadjusted p-values of differential\n gene expression between basal breast cancers \nin TCGA black and \nTCGA white breast cancer patients&quot;)</code></pre>
<p><img src="figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/DE:%20TCGA%20black%20and%20TCGA%20white-1.png" width="672" style="display: block; margin: auto;" /></p>
<details> <summary><em>Expand here to see past versions of DE: TCGA black and TCGA white-1.png:</em></summary>
<table style="border-collapse:separate; border-spacing:5px;">
<thead>
<tr>
<th style="text-align:left;">
Version
</th>
<th style="text-align:left;">
Author
</th>
<th style="text-align:left;">
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<a href="https://github.com/parajago/TCGA-Nigerian-RNAseq/blob/303135894e957747263e7211bf29d9d74eacdbbc/docs/figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/DE: TCGA black and TCGA white-1.png" target="_blank">3031358</a>
</td>
<td style="text-align:left;">
Sheila Rajagopal
</td>
<td style="text-align:left;">
2019-03-06
</td>
</tr>
</tbody>
</table>
<p></details></p>
<pre class="r"><code>with(restemp, plot(log2FoldChange, -log10(padj), pch=20, main=&quot;Volcano plot of differential gene expression between basal \nbreast cancers in TCGA black and \nTCGA white breast cancer patients&quot;, xlim=c(-50,50), ylim=c(0,70)))
with(subset(restemp, padj&lt;0.01 &amp; abs(log2FoldChange)&gt;25), points(log2FoldChange, -log10(pvalue), pch=20, col=&quot;blue&quot;))
with(subset(restemp, padj&lt;0.01 &amp; abs(log2FoldChange)&gt;25), textxy(log2FoldChange, -log10(padj), labs=symbol, cex=.5))</code></pre>
<p><img src="figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/DE:%20TCGA%20black%20and%20TCGA%20white-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>diffTCGAres &lt;- as.data.frame(diffTCGA)[, ]
write.csv(diffTCGAres, file = &quot;TCGAblackwhite-basal-test-protcod.csv&quot;)</code></pre>
<p>This is a comparison of 32 Nigerian basal cases and 17 TCGA white basal cases.</p>
<pre class="r"><code>resBasal&lt;- results(ddsMFbe, contrast=c(&quot;sampleCondition&quot;, &quot;Nigerian.Basal&quot;, &quot;TCGA_white.Basal&quot;), alpha=0.05)
resBasal &lt;- subset(resBasal, padj &lt; 0.05) #Selecting only the lowest threshold of significant findings
resBasal$temp &lt;- row.names(resBasal)
resBasal$temp &lt;- gsub(&quot;[.].+&quot;, &quot;&quot;, resBasal$temp)

restemp &lt;- NULL
restemp &lt;- results(ddsMFbe, contrast=c(&quot;sampleCondition&quot;, &quot;Nigerian.Basal&quot;, &quot;TCGA_white.Basal&quot;), alpha=0.05)
restemp &lt;- lfcShrink(ddsMFbe, contrast=c(&quot;sampleCondition&quot;, &quot;Nigerian.Basal&quot;, &quot;TCGA_white.Basal&quot;), res = restemp, type=&quot;ashr&quot;, optmethod = &quot;mixEM&quot;)

restemp$temp &lt;- row.names(restemp)
restemp$temp &lt;- gsub(&quot;[.].+&quot;, &quot;&quot;, restemp$temp)

restemp$symbol &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=restemp$temp,
                     column=&quot;SYMBOL&quot;,
                     keytype=&quot;GENEID&quot;,           
                     multiVals=&quot;first&quot;)

resBasal$symbol &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=resBasal$temp,
                     column=&quot;SYMBOL&quot;,
                     keytype=&quot;GENEID&quot;,           
                     multiVals=&quot;first&quot;)

resBasal$biotype &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=resBasal$temp,
                     column=&quot;GENEBIOTYPE&quot;,
                     keytype=&quot;GENEID&quot;,           
                     multiVals=&quot;first&quot;)

resBasal$chr &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=resBasal$temp,
                     column=&quot;SEQNAME&quot;,
                     keytype=&quot;GENEID&quot;,           
                     multiVals=&quot;first&quot;)

resBasal$locstart &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=resBasal$temp,
                     column=&quot;GENESEQSTART&quot;,
                     keytype=&quot;GENEID&quot;,
                     multiVals=&quot;first&quot;)

resBasal$locend &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=resBasal$temp,
                     column=&quot;GENESEQEND&quot;,
                     keytype=&quot;GENEID&quot;,
                     multiVals=&quot;first&quot;)

hist(restemp$pvalue, main=&quot;Histogram of unadjusted p-values of differential\n gene expression between basal breast cancers \nin Nigerian and \nTCGA white breast cancer patients&quot;)</code></pre>
<p><img src="figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/DE:%20Basal%20breast%20-%20Nigerian%20and%20TCGA%20white-1.png" width="672" style="display: block; margin: auto;" /></p>
<details> <summary><em>Expand here to see past versions of DE: Basal breast - Nigerian and TCGA white-1.png:</em></summary>
<table style="border-collapse:separate; border-spacing:5px;">
<thead>
<tr>
<th style="text-align:left;">
Version
</th>
<th style="text-align:left;">
Author
</th>
<th style="text-align:left;">
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<a href="https://github.com/parajago/TCGA-Nigerian-RNAseq/blob/303135894e957747263e7211bf29d9d74eacdbbc/docs/figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/DE: Basal breast - Nigerian and TCGA white-1.png" target="_blank">3031358</a>
</td>
<td style="text-align:left;">
Sheila Rajagopal
</td>
<td style="text-align:left;">
2019-03-06
</td>
</tr>
</tbody>
</table>
<p></details></p>
<pre class="r"><code>with(restemp, plot(log2FoldChange, -log10(padj), pch=20, main=&quot;Volcano plot of differential gene expression between basal \nbreast cancers in Nigerian and \nTCGA white breast cancer patients&quot;, xlim=c(-50,50), ylim=c(0,70)))
with(subset(restemp, padj&lt;0.01 &amp; abs(log2FoldChange)&gt;25), points(log2FoldChange, -log10(pvalue), pch=20, col=&quot;blue&quot;))
with(subset(restemp, padj&lt;0.01 &amp; abs(log2FoldChange)&gt;25), textxy(log2FoldChange, -log10(padj), labs=symbol, cex=.5))</code></pre>
<p><img src="figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/DE:%20Basal%20breast%20-%20Nigerian%20and%20TCGA%20white-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>diffNigerianwhitebasal &lt;- as.data.frame(resBasal)[, ]
write.csv(diffNigerianwhitebasal, file = &quot;Nigerian-white-basal-protcod.csv&quot;)</code></pre>
<p>This is a comparison of 32 Nigerian basal cases and 25 TCGA black basal cases.</p>
<pre class="r"><code>resBasalblack&lt;- results(ddsMFbe, contrast=c(&quot;sampleCondition&quot;, &quot;Nigerian.Basal&quot;, &quot;TCGA_black.Basal&quot;), alpha=0.05)
resBasalblack &lt;- subset(resBasalblack, padj &lt; 0.05) #Selecting only the lowest threshold of significant findings
resBasalblack$temp &lt;- row.names(resBasalblack)
resBasalblack$temp &lt;- gsub(&quot;[.].+&quot;, &quot;&quot;, resBasalblack$temp)

restemp &lt;- NULL
restemp &lt;- results(ddsMFbe, contrast=c(&quot;sampleCondition&quot;, &quot;Nigerian.Basal&quot;, &quot;TCGA_black.Basal&quot;), alpha=0.05)
restemp &lt;- lfcShrink(ddsMFbe, contrast=c(&quot;sampleCondition&quot;, &quot;Nigerian.Basal&quot;, &quot;TCGA_black.Basal&quot;), res = restemp, type=&quot;ashr&quot;, optmethod = &quot;mixEM&quot;)

restemp$temp &lt;- row.names(restemp)
restemp$temp &lt;- gsub(&quot;[.].+&quot;, &quot;&quot;, restemp$temp)

restemp$symbol &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=restemp$temp,
                     column=&quot;SYMBOL&quot;,
                     keytype=&quot;GENEID&quot;,           
                     multiVals=&quot;first&quot;)

resBasalblack$symbol &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=resBasalblack$temp,
                     column=&quot;SYMBOL&quot;,
                     keytype=&quot;GENEID&quot;,           
                     multiVals=&quot;first&quot;)

resBasalblack$biotype &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=resBasalblack$temp,
                     column=&quot;GENEBIOTYPE&quot;,
                     keytype=&quot;GENEID&quot;,           
                     multiVals=&quot;first&quot;)

resBasalblack$chr &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=resBasalblack$temp,
                     column=&quot;SEQNAME&quot;,
                     keytype=&quot;GENEID&quot;,           
                     multiVals=&quot;first&quot;)

resBasalblack$locstart &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=resBasalblack$temp,
                     column=&quot;GENESEQSTART&quot;,
                     keytype=&quot;GENEID&quot;,
                     multiVals=&quot;first&quot;)

resBasalblack$locend &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=resBasalblack$temp,
                     column=&quot;GENESEQEND&quot;,
                     keytype=&quot;GENEID&quot;,
                     multiVals=&quot;first&quot;)

hist(restemp$pvalue, main=&quot;Histogram of unadjusted p-values of differential\n gene expression between basal breast cancers \nin Nigerian and \nTCGA black breast cancer patients&quot;)</code></pre>
<p><img src="figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/DE:%20Basal%20breast%20-%20Nigerian%20and%20TCGA%20black-1.png" width="672" style="display: block; margin: auto;" /></p>
<details> <summary><em>Expand here to see past versions of DE: Basal breast - Nigerian and TCGA black-1.png:</em></summary>
<table style="border-collapse:separate; border-spacing:5px;">
<thead>
<tr>
<th style="text-align:left;">
Version
</th>
<th style="text-align:left;">
Author
</th>
<th style="text-align:left;">
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<a href="https://github.com/parajago/TCGA-Nigerian-RNAseq/blob/303135894e957747263e7211bf29d9d74eacdbbc/docs/figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/DE: Basal breast - Nigerian and TCGA black-1.png" target="_blank">3031358</a>
</td>
<td style="text-align:left;">
Sheila Rajagopal
</td>
<td style="text-align:left;">
2019-03-06
</td>
</tr>
</tbody>
</table>
<p></details></p>
<pre class="r"><code>with(restemp, plot(log2FoldChange, -log10(padj), pch=20, main=&quot;Volcano plot of differential gene expression between basal \nbreast cancers in Nigerian and \nTCGA black breast cancer patients&quot;, xlim=c(-50,50), ylim=c(0,70)))
with(subset(restemp, padj&lt;0.01 &amp; abs(log2FoldChange)&gt;25), points(log2FoldChange, -log10(pvalue), pch=20, col=&quot;blue&quot;))
with(subset(restemp, padj&lt;0.01 &amp; abs(log2FoldChange)&gt;25), textxy(log2FoldChange, -log10(padj), labs=symbol, cex=.5))</code></pre>
<p><img src="figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/DE:%20Basal%20breast%20-%20Nigerian%20and%20TCGA%20black-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>diffNigerianblackbasal &lt;- as.data.frame(resBasalblack)[, ]
write.csv(diffNigerianblackbasal, file = &quot;Nigerian-black-basal-protcod.csv&quot;)</code></pre>
<p>This is a comparison of 26 Nigerian Her2 cases and 5 TCGA white Her2 cases. There are no TCGA black Her2 cases available for this analysis.</p>
<pre class="r"><code>resHer2&lt;- results(ddsMFbe, contrast=c(&quot;sampleCondition&quot;, &quot;Nigerian.Her2&quot;, &quot;TCGA_white.Her2&quot;), alpha=0.05)
resHer2 &lt;- subset(resHer2, padj &lt; 0.05) #Selecting only the lowest threshold of significant findings
resHer2$temp &lt;- row.names(resHer2)
resHer2$temp &lt;- gsub(&quot;[.].+&quot;, &quot;&quot;, resHer2$temp)

restemp &lt;- NULL
restemp &lt;- results(ddsMFbe, contrast=c(&quot;sampleCondition&quot;, &quot;Nigerian.Her2&quot;, &quot;TCGA_white.Her2&quot;), alpha=0.05)
restemp &lt;- lfcShrink(ddsMFbe, contrast=c(&quot;sampleCondition&quot;, &quot;Nigerian.Her2&quot;, &quot;TCGA_white.Her2&quot;), res = restemp, type=&quot;ashr&quot;, optmethod = &quot;mixEM&quot;)

restemp$temp &lt;- row.names(restemp)
restemp$temp &lt;- gsub(&quot;[.].+&quot;, &quot;&quot;, restemp$temp)

restemp$symbol &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=restemp$temp,
                     column=&quot;SYMBOL&quot;,
                     keytype=&quot;GENEID&quot;,           
                     multiVals=&quot;first&quot;)

resHer2$symbol &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=resHer2$temp,
                     column=&quot;SYMBOL&quot;,
                     keytype=&quot;GENEID&quot;,           
                     multiVals=&quot;first&quot;)

resHer2$biotype &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=resHer2$temp,
                     column=&quot;GENEBIOTYPE&quot;,
                     keytype=&quot;GENEID&quot;,           
                     multiVals=&quot;first&quot;)

resHer2$chr &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=resHer2$temp,
                     column=&quot;SEQNAME&quot;,
                     keytype=&quot;GENEID&quot;,           
                     multiVals=&quot;first&quot;)

resHer2$locstart &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=resHer2$temp,
                     column=&quot;GENESEQSTART&quot;,
                     keytype=&quot;GENEID&quot;,
                     multiVals=&quot;first&quot;)

resHer2$locend &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=resHer2$temp,
                     column=&quot;GENESEQEND&quot;,
                     keytype=&quot;GENEID&quot;,
                     multiVals=&quot;first&quot;)

hist(restemp$pvalue, main=&quot;Histogram of unadjusted p-values of differential\n gene expression between HER2 breast cancers \nin Nigerian and \nTCGA white breast cancer patients&quot;)</code></pre>
<p><img src="figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/DE%20Her2%20breast%20-%20Nigerian%20and%20TCGA%20white-1.png" width="672" style="display: block; margin: auto;" /></p>
<details> <summary><em>Expand here to see past versions of DE Her2 breast - Nigerian and TCGA white-1.png:</em></summary>
<table style="border-collapse:separate; border-spacing:5px;">
<thead>
<tr>
<th style="text-align:left;">
Version
</th>
<th style="text-align:left;">
Author
</th>
<th style="text-align:left;">
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<a href="https://github.com/parajago/TCGA-Nigerian-RNAseq/blob/303135894e957747263e7211bf29d9d74eacdbbc/docs/figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/DE Her2 breast - Nigerian and TCGA white-1.png" target="_blank">3031358</a>
</td>
<td style="text-align:left;">
Sheila Rajagopal
</td>
<td style="text-align:left;">
2019-03-06
</td>
</tr>
</tbody>
</table>
<p></details></p>
<pre class="r"><code>with(restemp, plot(log2FoldChange, -log10(padj), pch=20, main=&quot;Volcano plot of differential gene expression between Her2 \nbreast cancers in Nigerian and \nTCGA white breast cancer patients&quot;, xlim=c(-50,50), ylim=c(0,70)))
with(subset(restemp, padj&lt;0.01 &amp; abs(log2FoldChange)&gt;25), points(log2FoldChange, -log10(pvalue), pch=20, col=&quot;blue&quot;))
with(subset(restemp, padj&lt;0.01 &amp; abs(log2FoldChange)&gt;25), textxy(log2FoldChange, -log10(padj), labs=symbol, cex=.5))</code></pre>
<p><img src="figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/DE%20Her2%20breast%20-%20Nigerian%20and%20TCGA%20white-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>diffNigerianwhiteHER2 &lt;- as.data.frame(resHer2)[, ]
write.csv(diffNigerianwhiteHER2, file = &quot;Nigerian-white-HER2-protcod.csv&quot;)</code></pre>
<p>This is a comparison of 16 Nigerian luminal A cases and 8 TCGA white luminal A cases.</p>
<pre class="r"><code>resLumA&lt;- results(ddsMFbe, contrast=c(&quot;sampleCondition&quot;, &quot;Nigerian.LumA&quot;, &quot;TCGA_white.LumA&quot;), alpha=0.05)
resLumA &lt;- subset(resLumA, padj &lt; 0.05) #Selecting only the lowest threshold of significant findings
resLumA$temp &lt;- row.names(resLumA)
resLumA$temp &lt;- gsub(&quot;[.].+&quot;, &quot;&quot;, resLumA$temp)

restemp &lt;- NULL
restemp &lt;- results(ddsMFbe, contrast=c(&quot;sampleCondition&quot;, &quot;Nigerian.LumA&quot;, &quot;TCGA_white.LumA&quot;), alpha=0.05)
restemp &lt;- lfcShrink(ddsMFbe, contrast=c(&quot;sampleCondition&quot;, &quot;Nigerian.LumA&quot;, &quot;TCGA_white.LumA&quot;), res = restemp, type=&quot;ashr&quot;, optmethod = &quot;mixEM&quot;)

restemp$temp &lt;- row.names(restemp)
restemp$temp &lt;- gsub(&quot;[.].+&quot;, &quot;&quot;, restemp$temp)

restemp$symbol &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=restemp$temp,
                     column=&quot;SYMBOL&quot;,
                     keytype=&quot;GENEID&quot;,           
                     multiVals=&quot;first&quot;)

resLumA$symbol &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=resLumA$temp,
                     column=&quot;SYMBOL&quot;,
                     keytype=&quot;GENEID&quot;,           
                     multiVals=&quot;first&quot;)

resLumA$biotype &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=resLumA$temp,
                     column=&quot;GENEBIOTYPE&quot;,
                     keytype=&quot;GENEID&quot;,           
                     multiVals=&quot;first&quot;)

resLumA$chr &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=resLumA$temp,
                     column=&quot;SEQNAME&quot;,
                     keytype=&quot;GENEID&quot;,           
                     multiVals=&quot;first&quot;)

resLumA$locstart &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=resLumA$temp,
                     column=&quot;GENESEQSTART&quot;,
                     keytype=&quot;GENEID&quot;,
                     multiVals=&quot;first&quot;)

resLumA$locend &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=resLumA$temp,
                     column=&quot;GENESEQEND&quot;,
                     keytype=&quot;GENEID&quot;,
                     multiVals=&quot;first&quot;)

hist(restemp$pvalue, main=&quot;Histogram of unadjusted p-values of differential\n gene expression between Luminal A breast cancers \nin Nigerian and \nTCGA white breast cancer patients&quot;)</code></pre>
<p><img src="figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/DE%20LuminalA%20breast%20-%20Nigerian%20and%20TCGA%20white-1.png" width="672" style="display: block; margin: auto;" /></p>
<details> <summary><em>Expand here to see past versions of DE LuminalA breast - Nigerian and TCGA white-1.png:</em></summary>
<table style="border-collapse:separate; border-spacing:5px;">
<thead>
<tr>
<th style="text-align:left;">
Version
</th>
<th style="text-align:left;">
Author
</th>
<th style="text-align:left;">
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<a href="https://github.com/parajago/TCGA-Nigerian-RNAseq/blob/303135894e957747263e7211bf29d9d74eacdbbc/docs/figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/DE LuminalA breast - Nigerian and TCGA white-1.png" target="_blank">3031358</a>
</td>
<td style="text-align:left;">
Sheila Rajagopal
</td>
<td style="text-align:left;">
2019-03-06
</td>
</tr>
</tbody>
</table>
<p></details></p>
<pre class="r"><code>with(restemp, plot(log2FoldChange, -log10(padj), pch=20, main=&quot;Volcano plot of differential gene expression between Luminal A \nbreast cancers in Nigerian and \nTCGA white breast cancer patients&quot;, xlim=c(-50,50), ylim=c(0,70)))
with(subset(restemp, padj&lt;0.01 &amp; abs(log2FoldChange)&gt;25), points(log2FoldChange, -log10(pvalue), pch=20, col=&quot;blue&quot;))
with(subset(restemp, padj&lt;0.01 &amp; abs(log2FoldChange)&gt;25), textxy(log2FoldChange, -log10(padj), labs=symbol, cex=.5))</code></pre>
<p><img src="figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/DE%20LuminalA%20breast%20-%20Nigerian%20and%20TCGA%20white-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>diffNigerianwhiteLumA &lt;- as.data.frame(resLumA)[, ]
write.csv(diffNigerianwhiteLumA, file = &quot;Nigerian-white-LumA-protcod.csv&quot;)</code></pre>
<p>This is a comparison of 16 Nigerian luminal A cases and 4 TCGA black luminal A cases.</p>
<pre class="r"><code>resLumAblack&lt;- results(ddsMFbe, contrast=c(&quot;sampleCondition&quot;, &quot;Nigerian.LumA&quot;, &quot;TCGA_black.LumA&quot;), alpha=0.05)
resLumAblack &lt;- subset(resLumAblack, padj &lt; 0.05) #Selecting only the lowest threshold of significant findings
resLumAblack$temp &lt;- row.names(resLumAblack)
resLumAblack$temp &lt;- gsub(&quot;[.].+&quot;, &quot;&quot;, resLumAblack$temp)

restemp &lt;- NULL
restemp &lt;- results(ddsMFbe, contrast=c(&quot;sampleCondition&quot;, &quot;Nigerian.LumA&quot;, &quot;TCGA_black.LumA&quot;), alpha=0.05)
restemp &lt;- lfcShrink(ddsMFbe, contrast=c(&quot;sampleCondition&quot;, &quot;Nigerian.LumA&quot;, &quot;TCGA_black.LumA&quot;), res = restemp, type=&quot;ashr&quot;, optmethod = &quot;mixEM&quot;)

restemp$temp &lt;- row.names(restemp)
restemp$temp &lt;- gsub(&quot;[.].+&quot;, &quot;&quot;, restemp$temp)

restemp$symbol &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=restemp$temp,
                     column=&quot;SYMBOL&quot;,
                     keytype=&quot;GENEID&quot;,           
                     multiVals=&quot;first&quot;)

resLumAblack$symbol &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=resLumAblack$temp,
                     column=&quot;SYMBOL&quot;,
                     keytype=&quot;GENEID&quot;,           
                     multiVals=&quot;first&quot;)

resLumAblack$biotype &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=resLumAblack$temp,
                     column=&quot;GENEBIOTYPE&quot;,
                     keytype=&quot;GENEID&quot;,           
                     multiVals=&quot;first&quot;)

resLumAblack$chr &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=resLumAblack$temp,
                     column=&quot;SEQNAME&quot;,
                     keytype=&quot;GENEID&quot;,           
                     multiVals=&quot;first&quot;)

resLumAblack$locstart &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=resLumAblack$temp,
                     column=&quot;GENESEQSTART&quot;,
                     keytype=&quot;GENEID&quot;,
                     multiVals=&quot;first&quot;)

resLumAblack$locend &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=resLumAblack$temp,
                     column=&quot;GENESEQEND&quot;,
                     keytype=&quot;GENEID&quot;,
                     multiVals=&quot;first&quot;)

hist(restemp$pvalue, main=&quot;Histogram of unadjusted p-values of differential\n gene expression between Luminal A breast cancers \nin Nigerian and \nTCGA black breast cancer patients&quot;)</code></pre>
<p><img src="figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/DE%20LuminalA%20breast%20-%20Nigerian%20and%20TCGA%20black-1.png" width="672" style="display: block; margin: auto;" /></p>
<details> <summary><em>Expand here to see past versions of DE LuminalA breast - Nigerian and TCGA black-1.png:</em></summary>
<table style="border-collapse:separate; border-spacing:5px;">
<thead>
<tr>
<th style="text-align:left;">
Version
</th>
<th style="text-align:left;">
Author
</th>
<th style="text-align:left;">
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<a href="https://github.com/parajago/TCGA-Nigerian-RNAseq/blob/303135894e957747263e7211bf29d9d74eacdbbc/docs/figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/DE LuminalA breast - Nigerian and TCGA black-1.png" target="_blank">3031358</a>
</td>
<td style="text-align:left;">
Sheila Rajagopal
</td>
<td style="text-align:left;">
2019-03-06
</td>
</tr>
</tbody>
</table>
<p></details></p>
<pre class="r"><code>with(restemp, plot(log2FoldChange, -log10(padj), pch=20, main=&quot;Volcano plot of differential gene expression between Luminal A \nbreast cancers in Nigerian and \nTCGA black breast cancer patients&quot;, xlim=c(-50,50), ylim=c(0,70)))
with(subset(restemp, padj&lt;0.01 &amp; abs(log2FoldChange)&gt;25), points(log2FoldChange, -log10(pvalue), pch=20, col=&quot;blue&quot;))
with(subset(restemp, padj&lt;0.01 &amp; abs(log2FoldChange)&gt;25), textxy(log2FoldChange, -log10(padj), labs=symbol, cex=.5))</code></pre>
<p><img src="figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/DE%20LuminalA%20breast%20-%20Nigerian%20and%20TCGA%20black-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>diffNigerianblackLumA &lt;- as.data.frame(resLumAblack)[, ]
write.csv(diffNigerianblackLumA, file = &quot;Nigerian-black-LumA-protcod.csv&quot;)</code></pre>
<p>This is a comparison of 18 nigerian luminal B cases and 9 TCGA white luminal B cases.</p>
<pre class="r"><code>resLumB&lt;- results(ddsMFbe, contrast=c(&quot;sampleCondition&quot;, &quot;Nigerian.LumB&quot;, &quot;TCGA_white.LumB&quot;), alpha=0.05)
resLumB &lt;- subset(resLumB, padj &lt; 0.05) #Selecting only the lowest threshold of significant findings
resLumB$temp &lt;- row.names(resLumB)
resLumB$temp &lt;- gsub(&quot;[.].+&quot;, &quot;&quot;, resLumB$temp)

restemp &lt;- NULL
restemp &lt;- results(ddsMFbe, contrast=c(&quot;sampleCondition&quot;, &quot;Nigerian.LumB&quot;, &quot;TCGA_white.LumB&quot;), alpha=0.05)
restemp &lt;- lfcShrink(ddsMFbe, contrast=c(&quot;sampleCondition&quot;, &quot;Nigerian.LumB&quot;, &quot;TCGA_white.LumB&quot;), res = restemp, type=&quot;ashr&quot;, optmethod = &quot;mixEM&quot;)

restemp$temp &lt;- row.names(restemp)
restemp$temp &lt;- gsub(&quot;[.].+&quot;, &quot;&quot;, restemp$temp)

restemp$symbol &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=restemp$temp,
                     column=&quot;SYMBOL&quot;,
                     keytype=&quot;GENEID&quot;,           
                     multiVals=&quot;first&quot;)

resLumB$symbol &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=resLumB$temp,
                     column=&quot;SYMBOL&quot;,
                     keytype=&quot;GENEID&quot;,           
                     multiVals=&quot;first&quot;)

resLumB$biotype &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=resLumB$temp,
                     column=&quot;GENEBIOTYPE&quot;,
                     keytype=&quot;GENEID&quot;,           
                     multiVals=&quot;first&quot;)

resLumB$chr &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=resLumB$temp,
                     column=&quot;SEQNAME&quot;,
                     keytype=&quot;GENEID&quot;,           
                     multiVals=&quot;first&quot;)

resLumB$locstart &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=resLumB$temp,
                     column=&quot;GENESEQSTART&quot;,
                     keytype=&quot;GENEID&quot;,
                     multiVals=&quot;first&quot;)

resLumB$locend &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=resLumB$temp,
                     column=&quot;GENESEQEND&quot;,
                     keytype=&quot;GENEID&quot;,
                     multiVals=&quot;first&quot;)

hist(restemp$pvalue, main=&quot;Histogram of unadjusted p-values of differential\n gene expression between Luminal B breast cancers \nin Nigerian and \nTCGA white breast cancer patients&quot;)</code></pre>
<p><img src="figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/DE%20LuminalB%20breast%20-%20Nigerian%20and%20TCGA%20white-1.png" width="672" style="display: block; margin: auto;" /></p>
<details> <summary><em>Expand here to see past versions of DE LuminalB breast - Nigerian and TCGA white-1.png:</em></summary>
<table style="border-collapse:separate; border-spacing:5px;">
<thead>
<tr>
<th style="text-align:left;">
Version
</th>
<th style="text-align:left;">
Author
</th>
<th style="text-align:left;">
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<a href="https://github.com/parajago/TCGA-Nigerian-RNAseq/blob/303135894e957747263e7211bf29d9d74eacdbbc/docs/figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/DE LuminalB breast - Nigerian and TCGA white-1.png" target="_blank">3031358</a>
</td>
<td style="text-align:left;">
Sheila Rajagopal
</td>
<td style="text-align:left;">
2019-03-06
</td>
</tr>
</tbody>
</table>
<p></details></p>
<pre class="r"><code>with(restemp, plot(log2FoldChange, -log10(padj), pch=20, main=&quot;Volcano plot of differential gene expression between Luminal B \nbreast cancers in Nigerian and \nTCGA white breast cancer patients&quot;, xlim=c(-50,50), ylim=c(0,70)))
with(subset(restemp, padj&lt;0.01 &amp; abs(log2FoldChange)&gt;25), points(log2FoldChange, -log10(pvalue), pch=20, col=&quot;blue&quot;))
with(subset(restemp, padj&lt;0.01 &amp; abs(log2FoldChange)&gt;25), textxy(log2FoldChange, -log10(padj), labs=symbol, cex=.5))</code></pre>
<p><img src="figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/DE%20LuminalB%20breast%20-%20Nigerian%20and%20TCGA%20white-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>diffNigerianwhiteLumB &lt;- as.data.frame(resLumB)[, ]
write.csv(diffNigerianwhiteLumB, file = &quot;Nigerian-white-LumB-protcod.csv&quot;)</code></pre>
<p>This is a comparison of 18 Nigerian luminal B cases and 4 TCGA black luminal B cases.</p>
<pre class="r"><code>resLumBblack&lt;- results(ddsMFbe, contrast=c(&quot;sampleCondition&quot;, &quot;Nigerian.LumB&quot;, &quot;TCGA_black.LumB&quot;), alpha=0.05)
resLumBblack &lt;- subset(resLumBblack, padj &lt; 0.05) #Selecting only the lowest threshold of significant findings
resLumBblack$temp &lt;- row.names(resLumBblack)
resLumBblack$temp &lt;- gsub(&quot;[.].+&quot;, &quot;&quot;, resLumBblack$temp)

restemp &lt;- NULL
restemp &lt;- results(ddsMFbe, contrast=c(&quot;sampleCondition&quot;, &quot;Nigerian.LumB&quot;, &quot;TCGA_black.LumB&quot;), alpha=0.05)
restemp &lt;- lfcShrink(ddsMFbe, contrast=c(&quot;sampleCondition&quot;, &quot;Nigerian.LumB&quot;, &quot;TCGA_black.LumB&quot;), res = restemp, type=&quot;ashr&quot;, optmethod = &quot;mixEM&quot;)

restemp$temp &lt;- row.names(restemp)
restemp$temp &lt;- gsub(&quot;[.].+&quot;, &quot;&quot;, restemp$temp)

restemp$symbol &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=restemp$temp,
                     column=&quot;SYMBOL&quot;,
                     keytype=&quot;GENEID&quot;,           
                     multiVals=&quot;first&quot;)

resLumBblack$symbol &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=resLumBblack$temp,
                     column=&quot;SYMBOL&quot;,
                     keytype=&quot;GENEID&quot;,           
                     multiVals=&quot;first&quot;)

resLumBblack$biotype &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=resLumBblack$temp,
                     column=&quot;GENEBIOTYPE&quot;,
                     keytype=&quot;GENEID&quot;,           
                     multiVals=&quot;first&quot;)

resLumBblack$chr &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=resLumBblack$temp,
                     column=&quot;SEQNAME&quot;,
                     keytype=&quot;GENEID&quot;,           
                     multiVals=&quot;first&quot;)

resLumBblack$locstart &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=resLumBblack$temp,
                     column=&quot;GENESEQSTART&quot;,
                     keytype=&quot;GENEID&quot;,
                     multiVals=&quot;first&quot;)

resLumBblack$locend &lt;- mapIds(EnsDb.Hsapiens.v75,
                     keys=resLumBblack$temp,
                     column=&quot;GENESEQEND&quot;,
                     keytype=&quot;GENEID&quot;,
                     multiVals=&quot;first&quot;)

hist(restemp$pvalue, main=&quot;Histogram of unadjusted p-values of differential\n gene expression between Luminal B breast cancers \nin Nigerian and \nTCGA black breast cancer patients&quot;)</code></pre>
<p><img src="figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/DE%20LuminalB%20breast%20-%20Nigerian%20and%20TCGA%20black-1.png" width="672" style="display: block; margin: auto;" /></p>
<details> <summary><em>Expand here to see past versions of DE LuminalB breast - Nigerian and TCGA black-1.png:</em></summary>
<table style="border-collapse:separate; border-spacing:5px;">
<thead>
<tr>
<th style="text-align:left;">
Version
</th>
<th style="text-align:left;">
Author
</th>
<th style="text-align:left;">
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<a href="https://github.com/parajago/TCGA-Nigerian-RNAseq/blob/303135894e957747263e7211bf29d9d74eacdbbc/docs/figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/DE LuminalB breast - Nigerian and TCGA black-1.png" target="_blank">3031358</a>
</td>
<td style="text-align:left;">
Sheila Rajagopal
</td>
<td style="text-align:left;">
2019-03-06
</td>
</tr>
</tbody>
</table>
<p></details></p>
<pre class="r"><code>with(restemp, plot(log2FoldChange, -log10(padj), pch=20, main=&quot;Volcano plot of differential gene expression between Luminal B \nbreast cancers in Nigerian and \nTCGA black breast cancer patients&quot;, xlim=c(-50,50), ylim=c(0,70)))
with(subset(restemp, padj&lt;0.01 &amp; abs(log2FoldChange)&gt;25), points(log2FoldChange, -log10(pvalue), pch=20, col=&quot;blue&quot;))
with(subset(restemp, padj&lt;0.01 &amp; abs(log2FoldChange)&gt;25), textxy(log2FoldChange, -log10(padj), labs=symbol, cex=.5))</code></pre>
<p><img src="figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/DE%20LuminalB%20breast%20-%20Nigerian%20and%20TCGA%20black-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>diffNigerianblackLumB &lt;- as.data.frame(resLumBblack)[, ]
write.csv(diffNigerianblackLumB, file = &quot;Nigerian-black-LumB-protcod.csv&quot;)</code></pre>
</div>
<div id="validation-of-results" class="section level1">
<h1>Validation of results</h1>
<pre class="r"><code>chromecheck &lt;- factor(diffNigerianblackbasal$chr)
plot(table(chromecheck))</code></pre>
<p><img src="figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/Checking%20distribution%20of%20all%20results%20by%20chromosome-1.png" width="672" style="display: block; margin: auto;" /></p>
<details> <summary><em>Expand here to see past versions of Checking distribution of all results by chromosome-1.png:</em></summary>
<table style="border-collapse:separate; border-spacing:5px;">
<thead>
<tr>
<th style="text-align:left;">
Version
</th>
<th style="text-align:left;">
Author
</th>
<th style="text-align:left;">
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<a href="https://github.com/parajago/TCGA-Nigerian-RNAseq/blob/303135894e957747263e7211bf29d9d74eacdbbc/docs/figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/Checking distribution of all results by chromosome-1.png" target="_blank">3031358</a>
</td>
<td style="text-align:left;">
Sheila Rajagopal
</td>
<td style="text-align:left;">
2019-03-06
</td>
</tr>
</tbody>
</table>
<p></details></p>
<pre class="r"><code>chromecheck2 &lt;- factor(diffNigerianwhitebasal$chr)
plot(table(chromecheck2))</code></pre>
<p><img src="figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/Checking%20distribution%20of%20all%20results%20by%20chromosome-2.png" width="672" style="display: block; margin: auto;" /></p>
<details> <summary><em>Expand here to see past versions of Checking distribution of all results by chromosome-2.png:</em></summary>
<table style="border-collapse:separate; border-spacing:5px;">
<thead>
<tr>
<th style="text-align:left;">
Version
</th>
<th style="text-align:left;">
Author
</th>
<th style="text-align:left;">
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<a href="https://github.com/parajago/TCGA-Nigerian-RNAseq/blob/303135894e957747263e7211bf29d9d74eacdbbc/docs/figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/Checking distribution of all results by chromosome-2.png" target="_blank">3031358</a>
</td>
<td style="text-align:left;">
Sheila Rajagopal
</td>
<td style="text-align:left;">
2019-03-06
</td>
</tr>
</tbody>
</table>
<p></details></p>
<pre class="r"><code>chromecheck3 &lt;- factor(diffNigerianwhiteHER2$chr)
plot(table(chromecheck3))</code></pre>
<p><img src="figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/Checking%20distribution%20of%20all%20results%20by%20chromosome-3.png" width="672" style="display: block; margin: auto;" /></p>
<details> <summary><em>Expand here to see past versions of Checking distribution of all results by chromosome-3.png:</em></summary>
<table style="border-collapse:separate; border-spacing:5px;">
<thead>
<tr>
<th style="text-align:left;">
Version
</th>
<th style="text-align:left;">
Author
</th>
<th style="text-align:left;">
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<a href="https://github.com/parajago/TCGA-Nigerian-RNAseq/blob/303135894e957747263e7211bf29d9d74eacdbbc/docs/figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/Checking distribution of all results by chromosome-3.png" target="_blank">3031358</a>
</td>
<td style="text-align:left;">
Sheila Rajagopal
</td>
<td style="text-align:left;">
2019-03-06
</td>
</tr>
</tbody>
</table>
<p></details></p>
<pre class="r"><code>chromecheck4 &lt;- factor(diffNigerianwhiteLumA$chr)
plot(table(chromecheck4))</code></pre>
<p><img src="figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/Checking%20distribution%20of%20all%20results%20by%20chromosome-4.png" width="672" style="display: block; margin: auto;" /></p>
<details> <summary><em>Expand here to see past versions of Checking distribution of all results by chromosome-4.png:</em></summary>
<table style="border-collapse:separate; border-spacing:5px;">
<thead>
<tr>
<th style="text-align:left;">
Version
</th>
<th style="text-align:left;">
Author
</th>
<th style="text-align:left;">
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<a href="https://github.com/parajago/TCGA-Nigerian-RNAseq/blob/303135894e957747263e7211bf29d9d74eacdbbc/docs/figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/Checking distribution of all results by chromosome-4.png" target="_blank">3031358</a>
</td>
<td style="text-align:left;">
Sheila Rajagopal
</td>
<td style="text-align:left;">
2019-03-06
</td>
</tr>
</tbody>
</table>
<p></details></p>
<pre class="r"><code>chromecheck5 &lt;- factor(diffNigerianblackLumA$chr)
plot(table(chromecheck5))</code></pre>
<p><img src="figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/Checking%20distribution%20of%20all%20results%20by%20chromosome-5.png" width="672" style="display: block; margin: auto;" /></p>
<details> <summary><em>Expand here to see past versions of Checking distribution of all results by chromosome-5.png:</em></summary>
<table style="border-collapse:separate; border-spacing:5px;">
<thead>
<tr>
<th style="text-align:left;">
Version
</th>
<th style="text-align:left;">
Author
</th>
<th style="text-align:left;">
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<a href="https://github.com/parajago/TCGA-Nigerian-RNAseq/blob/303135894e957747263e7211bf29d9d74eacdbbc/docs/figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/Checking distribution of all results by chromosome-5.png" target="_blank">3031358</a>
</td>
<td style="text-align:left;">
Sheila Rajagopal
</td>
<td style="text-align:left;">
2019-03-06
</td>
</tr>
</tbody>
</table>
<p></details></p>
<pre class="r"><code>chromecheck6 &lt;- factor(diffNigerianwhiteLumB$chr)
plot(table(chromecheck6))</code></pre>
<p><img src="figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/Checking%20distribution%20of%20all%20results%20by%20chromosome-6.png" width="672" style="display: block; margin: auto;" /></p>
<details> <summary><em>Expand here to see past versions of Checking distribution of all results by chromosome-6.png:</em></summary>
<table style="border-collapse:separate; border-spacing:5px;">
<thead>
<tr>
<th style="text-align:left;">
Version
</th>
<th style="text-align:left;">
Author
</th>
<th style="text-align:left;">
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<a href="https://github.com/parajago/TCGA-Nigerian-RNAseq/blob/303135894e957747263e7211bf29d9d74eacdbbc/docs/figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/Checking distribution of all results by chromosome-6.png" target="_blank">3031358</a>
</td>
<td style="text-align:left;">
Sheila Rajagopal
</td>
<td style="text-align:left;">
2019-03-06
</td>
</tr>
</tbody>
</table>
<p></details></p>
<pre class="r"><code>chromecheck7 &lt;- factor(diffNigerianblackLumB$chr)
plot(table(chromecheck7))</code></pre>
<p><img src="figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/Checking%20distribution%20of%20all%20results%20by%20chromosome-7.png" width="672" style="display: block; margin: auto;" /></p>
<details> <summary><em>Expand here to see past versions of Checking distribution of all results by chromosome-7.png:</em></summary>
<table style="border-collapse:separate; border-spacing:5px;">
<thead>
<tr>
<th style="text-align:left;">
Version
</th>
<th style="text-align:left;">
Author
</th>
<th style="text-align:left;">
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<a href="https://github.com/parajago/TCGA-Nigerian-RNAseq/blob/303135894e957747263e7211bf29d9d74eacdbbc/docs/figure/NigerianTCGArawcountsDeSeq2-proteincoding.Rmd/Checking distribution of all results by chromosome-7.png" target="_blank">3031358</a>
</td>
<td style="text-align:left;">
Sheila Rajagopal
</td>
<td style="text-align:left;">
2019-03-06
</td>
</tr>
</tbody>
</table>
<p></details></p>
<div id="session-information" class="section level2">
<h2>Session information</h2>
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 3.5.0 (2018-04-23)
Platform: x86_64-apple-darwin15.6.0 (64-bit)
Running under: macOS Sierra 10.12.5

Matrix products: default
BLAS: /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libRblas.0.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] parallel  stats4    stats     graphics  grDevices utils     datasets 
[8] methods   base     

other attached packages:
 [1] ashr_2.2-7                  gplots_3.0.1.1             
 [3] calibrate_1.7.2             MASS_7.3-51.1              
 [5] limma_3.38.3                sva_3.30.1                 
 [7] mgcv_1.8-26                 nlme_3.1-137               
 [9] pheatmap_1.0.12             genefilter_1.64.0          
[11] EnsDb.Hsapiens.v75_2.99.0   ensembldb_2.6.3            
[13] AnnotationFilter_1.6.0      GenomicFeatures_1.34.1     
[15] org.Hs.eg.db_3.7.0          AnnotationDbi_1.44.0       
[17] hexbin_1.27.2               ggplot2_3.1.0              
[19] dplyr_0.7.8                 stringi_1.2.4              
[21] DESeq2_1.22.2               SummarizedExperiment_1.12.0
[23] DelayedArray_0.8.0          BiocParallel_1.16.5        
[25] matrixStats_0.54.0          Biobase_2.42.0             
[27] GenomicRanges_1.34.0        GenomeInfoDb_1.18.1        
[29] IRanges_2.16.0              S4Vectors_0.20.1           
[31] BiocGenerics_0.28.0        

loaded via a namespace (and not attached):
  [1] colorspace_1.4-0         rprojroot_1.3-2         
  [3] htmlTable_1.13.1         XVector_0.22.0          
  [5] base64enc_0.1-3          rstudioapi_0.9.0        
  [7] bit64_0.9-7              codetools_0.2-16        
  [9] splines_3.5.0            R.methodsS3_1.7.1       
 [11] pscl_1.5.2               doParallel_1.0.14       
 [13] geneplotter_1.60.0       knitr_1.21              
 [15] Formula_1.2-3            workflowr_1.1.1         
 [17] Rsamtools_1.34.0         annotate_1.60.0         
 [19] cluster_2.0.7-1          R.oo_1.22.0             
 [21] compiler_3.5.0           httr_1.4.0              
 [23] backports_1.1.3          assertthat_0.2.0        
 [25] Matrix_1.2-15            lazyeval_0.2.1          
 [27] acepack_1.4.1            htmltools_0.3.6         
 [29] prettyunits_1.0.2        tools_3.5.0             
 [31] bindrcpp_0.2.2           gtable_0.2.0            
 [33] glue_1.3.0               GenomeInfoDbData_1.2.0  
 [35] reshape2_1.4.3           Rcpp_1.0.0              
 [37] Biostrings_2.50.2        gdata_2.18.0            
 [39] rtracklayer_1.42.1       iterators_1.0.10        
 [41] xfun_0.4                 stringr_1.3.1           
 [43] gtools_3.8.1             XML_3.98-1.16           
 [45] zlibbioc_1.28.0          scales_1.0.0            
 [47] hms_0.4.2                ProtGenerics_1.14.0     
 [49] RColorBrewer_1.1-2       yaml_2.2.0              
 [51] curl_3.3                 memoise_1.1.0           
 [53] gridExtra_2.3            biomaRt_2.38.0          
 [55] rpart_4.1-13             SQUAREM_2017.10-1       
 [57] latticeExtra_0.6-28      RSQLite_2.1.1           
 [59] foreach_1.4.4            checkmate_1.9.1         
 [61] caTools_1.17.1.1         truncnorm_1.0-8         
 [63] rlang_0.3.1              pkgconfig_2.0.2         
 [65] bitops_1.0-6             evaluate_0.12           
 [67] lattice_0.20-38          purrr_0.2.5             
 [69] bindr_0.1.1              labeling_0.3            
 [71] GenomicAlignments_1.18.1 htmlwidgets_1.3         
 [73] bit_1.1-14               tidyselect_0.2.5        
 [75] plyr_1.8.4               magrittr_1.5            
 [77] R6_2.3.0                 Hmisc_4.1-1             
 [79] DBI_1.0.0                pillar_1.3.1            
 [81] whisker_0.3-2            foreign_0.8-71          
 [83] withr_2.1.2              survival_2.43-3         
 [85] RCurl_1.95-4.11          nnet_7.3-12             
 [87] tibble_2.0.1             crayon_1.3.4            
 [89] KernSmooth_2.23-15       rmarkdown_1.11          
 [91] progress_1.2.0           locfit_1.5-9.1          
 [93] grid_3.5.0               data.table_1.12.0       
 [95] blob_1.1.1               git2r_0.24.0            
 [97] digest_0.6.18            xtable_1.8-3            
 [99] R.utils_2.7.0            munsell_0.5.0           </code></pre>
</div>
</div>

<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
http://docs.mathjax.org/en/latest/configuration.html.  This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>

<hr>
<p>
  This reproducible <a href="http://rmarkdown.rstudio.com">R Markdown</a>
  analysis was created with
  <a href="https://github.com/jdblischak/workflowr">workflowr</a> 1.1.1
</p>
<hr>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
